<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Evasion Tactics For Scanning Targets (Active Scan)" /><meta property="og:locale" content="en" /><meta name="description" content="IDS / IPS Firewall Detection Techniques" /><meta property="og:description" content="IDS / IPS Firewall Detection Techniques" /><link rel="canonical" href="https://secybr.com/posts/evasion-tactics-for-scanning-targets/" /><meta property="og:url" content="https://secybr.com/posts/evasion-tactics-for-scanning-targets/" /><meta property="og:site_name" content="secybr penetration testing, red teaming and hack tricks." /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-06T00:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Evasion Tactics For Scanning Targets (Active Scan)" /><meta name="twitter:site" content="@0xhav0c" /><meta name="google-site-verification" content="405asbYxUs5N1iqL1zGg56yq-OlAtdexlSaC3FC7c9s" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-08T16:33:07+03:00","datePublished":"2022-12-06T00:00:00+03:00","description":"IDS / IPS Firewall Detection Techniques","headline":"Evasion Tactics For Scanning Targets (Active Scan)","mainEntityOfPage":{"@type":"WebPage","@id":"https://secybr.com/posts/evasion-tactics-for-scanning-targets/"},"url":"https://secybr.com/posts/evasion-tactics-for-scanning-targets/"}</script><title>Evasion Tactics For Scanning Targets (Active Scan) | secybr | penetration testing, red teaming and hack tricks.</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="secybr | penetration testing, red teaming and hack tricks."><meta name="application-name" content="secybr | penetration testing, red teaming and hack tricks."><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><meta content="secybr | penetration testing, red teaming and hack tricks." property="og:site_name"><meta content="Evasion Tactics For Scanning Targets (Active Scan)" property="og:title"><meta content="article" property="og:type"><meta content="penetration testing, red teaming and hack tricks." property="og:description"><meta content="https://secybr.com/posts/evasion-tactics-for-scanning-targets/" property="og:url"><meta content="2022-12-06T00:00:00+03:00" property="article:published_time"><meta content="https://secybr.com/about/" property="article:author"><meta content="https://secybr.com/assets/img/logo/logo.png" property="og:image"><meta content="red team" property="article:section"><meta content="evasion tactics" property="article:tag"><meta content="evasion technique" property="article:tag"><meta content="active scan evasion tactics" property="article:tag"><meta content="port scan evasion tactics" property="article:tag"><meta content="bypass IDS" property="article:tag"><meta content="bypass IPS" property="article:tag"><meta content="bypass firewall" property="article:tag"><meta content="bypass waf" property="article:tag"><meta content="red-team" property="article:tag"><meta property="og:image" content="https://secybr.com/assets/img/logo/logo.png"><meta name="twitter:site" content="secybr"><meta name="twitter:creator" content="0xhav0c"><meta name="twitter:title" content="Evasion Tactics For Scanning Targets (Active Scan)"><meta name="twitter:description" content="penetration testing, red teaming and hack tricks."><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://secybr.com/assets/img/logo/logo.png"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6320091248407168" crossorigin="anonymous"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/logo/logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">secybr</a></div><div class="site-subtitle">is a product of 0xhav0c</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/whoami/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>WHO AM I?</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/0xhav0c" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/0xhav0c" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['0xhavocc','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Evasion Tactics For Scanning Targets (Active Scan)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Evasion Tactics For Scanning Targets (Active Scan)</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1670274000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 6, 2022 </em> </span> <span> Updated <em class="" data-ts="1670506387" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 8, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/0xhav0c">0xhav0c</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2221 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><h1 id="ids--ips-firewall-detection-techniques">IDS / IPS Firewall Detection Techniques</h1><ul><li>Sending Bad Checksums<li>TCP ACK Scan (-sA)</ul><h2 id="sending-bad-checksums"><span class="mr-2">Sending Bad Checksums</span><a href="#sending-bad-checksums" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">nmap --badsum &lt;target IP&gt;</code> (–badsum is used to send the packets with bad or bogus TCP/UDP checksums to the intended target to avoid certain firewall rulesets)</p><p>The scan result shows all ports are filtered, indicating that there is no response or the packets are dropped, and thus it can be inferred that the system is configured.</p><h2 id="tcp-ack-scan--sa"><span class="mr-2">TCP ACK Scan (-sA)</span><a href="#tcp-ack-scan--sa" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>It is always good to send ACK packets instead of SYN packets because if there is any active firewall running on the remote computer it cannot generate firewall logs due to ACK packets because firewalls treat ACK packet as SYN’s response. package. TCP ACK scan, requires root privileges on the attacker side and performs very well for stateless firewall and IDS. As a penetration tester, you need to check the response of a firewall; There can be four types of responses:</p><ul><li>Open port (several ports in case of firewall)<li>Closed port (most ports are closed due to firewall)<li>Filtered (not sure if Nmap port is open)<li>Unfiltered (Nmap can access port but still confused about port open status)</ul><p>So these are some important answers you can get during a penetration test. ACK scanning is slightly different from other scanning techniques because it is not designed to discover open ports, but has the ability to identify filtered and unfiltered responses. Let’s compare the two results of an ACK scan.</p><p>If you need more details, you can check this guide from <a href="https://nmap.org/book/scan-methods-ack-scan.html">here</a>.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sA</span> 192.168.x.x
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/red-team/evasion.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/red-team/evasion1.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/red-team/evasion2.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/red-team/evasion3.png" alt="Untitled" data-proofer-ignore></p><h1 id="evasion-techniques">Evasion Techniques</h1><ul><li>Decoys<li>Proxies<li>User Agents<li>MAC Address Spoofing<li>Host Detection Methods (Ping Suppression)<li>Fragmentation<li>Timing<li>Changing Data length<li>Random Scan<li>Using Multiple Techniques</ul><h2 id="decoys"><span class="mr-2">Decoys</span><a href="#decoys" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>It is strictly not an evasion technique, but is used to hide the source of the scan. we still need to send packets from our IP address, but we can spoof other IP addresses during the scan so we can make the scan look like it’s coming from other hosts.</p><p>In this way, it can make it difficult for the security device to automatically block our IP and determine our IP.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>nmap <span class="nt">-D</span> RND:10 192.168.x.x <span class="c">#(Generates a random number of decoys)</span>
nmap <span class="nt">-sS</span> <span class="nt">--top-ports</span> 10 <span class="nt">-D</span> 192.168.xx.xx,192.168.yy.yy,10.10.xx.xx 8.8.8.8 <span class="c">#(Manually specify the IP addresses of the decoys)</span>
<span class="c"># Tip: If your target at the external network, you have to use external IP address. You can use many random different IP address. Just remember to use "," between two IP addresses.</span>
<span class="c"># For example usage</span>
nmap <span class="nt">-sS</span> <span class="nt">--top-ports</span> 10 <span class="nt">-D</span> 2.2.2.2,1.1.1.1 184.50.204.169
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/red-team/evasion4.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/red-team/evasion5.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/red-team/evasion6.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/red-team/evasion7.png" alt="Untitled" data-proofer-ignore></p><h2 id="proxies"><span class="mr-2">Proxies</span><a href="#proxies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="nmap-scanning-with-tor"><span class="mr-2">Nmap scanning with Tor</span><a href="#nmap-scanning-with-tor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get <span class="nb">install </span>tor

<span class="c">#Configuration tor</span>
<span class="nb">sudo </span>apt-get <span class="nb">install </span>ntpdate <span class="c">#Proxies need exact time settings from your system. Check your timezone, choose the one that is correct for your region.</span>
<span class="nb">sudo </span>ntpdate <span class="nt">-v</span> pool.ntp.org <span class="c"># After it's finished, reboot and you are good to go</span>
<span class="nb">sudo </span>apt-get <span class="nb">install </span>proxychains
</pre></table></code></div></div><p>ProxyChains is already configured to use Tor by default. You can verify this by looking up <code class="language-plaintext highlighter-rouge">/etc/proxychains.conf</code>. The last lines should be like these:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="o">[</span>ProxyList]
<span class="c"># add proxy here ...</span>
<span class="c"># meanwile</span>
<span class="c"># defaults set to "tor"</span>
socks4 127.0.0.1 9050
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>There are two proxychains.conf files in kali linux. For more effective results, after backing up the proxychains.conf file, update the proxychains4.conf file as proxychains.conf.</p></div></blockquote><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo cp</span> /etc/proxychains.conf /etc/proxychains.conf.bck
<span class="nb">sudo cp</span> /etc/proxychains4.conf /etc/proxychains.conf
</pre></table></code></div></div><p>We are now ready to perform an anonymous Nmap scan over the Tor network.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>proxychains nmap <span class="nt">-Pn</span> <span class="nt">-sV</span> <span class="nt">-p80</span> 116.62.x.x <span class="c">#If you don't get results the first time, you may have to try a few more times.</span>
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/red-team/evasion8.png" alt="Untitled" data-proofer-ignore></p><h3 id="nmap-through-tor-get-round-blocked-endpoints"><span class="mr-2">Nmap Through Tor: Get Round Blocked Endpoints</span><a href="#nmap-through-tor-get-round-blocked-endpoints" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>It is possible that we will encounter a situation where scan fails, because Tor endpoints are blocked.The solution may be in adding common public proxy server to the ‘chain’. We can do that by simply editing the <code class="language-plaintext highlighter-rouge">/etc/proxychains.conf</code> and adding a new entry at the end of the [ProxyList] (be sure that random_chain option is disabled).</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="o">[</span>ProxyList]
<span class="c"># add proxy here ...</span>
<span class="c"># meanwile</span>
<span class="c"># defaults set to "tor"</span>
socks4  127.0.0.1 9050
socks4 121.34.113.5 1080
</pre></table></code></div></div><h2 id="user-agents"><span class="mr-2">User Agents</span><a href="#user-agents" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>By default  Nmap comes fully bundled with <a href="https://nmap.org/book/nse.html">NSE</a> (Nmap Scripting-Engine) a fully integrated scripting engine with many useful libraries.</p><p>The http library is very commonly used, however many people dont realise they are using the user-agent  <code class="language-plaintext highlighter-rouge">Mozilla/5.0 (compatible; Nmap Scripting Engine; http://nmap.org/book/nse.html)</code></p><p>This is obviously a value you wouldn’t like to be used when pen-testing, as it would give your presence away on the battlefield, as they say. Additionally, it is easily detected and blocked (Unique to Nmap’s NSE http library).</p><blockquote class="prompt-tip"><div><p>If you are going to use an http script in your nmap scan, for example http enum or full port scan, don’t forget to change the user agent.</p></div></blockquote><p>Furthermore, Mod Security, and many other WAF’s (Web Application Firewalls) etc will quickly catch on to what you’re up to. For example a ModSecurity rule that detects and blocks this default user agent is:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>SecRule REQUEST_HEADERS:User-Agent <span class="s2">"@streq Mozilla/5.0 (compatible; Nmap Scripting Engine; http://nmap.org/book/nse.html)"</span> deny
</pre></table></code></div></div><p>With a good Sec setup on the server using ModSecurity, fail2ban etc would more than likely kick in, dropping your scanner’s connections.</p><p>According to the NMAP development team this value is left by “design” and that if you want to change it you have to use <code class="language-plaintext highlighter-rouge">--script-args http.useragent="some ua"</code> when launching your Nmap scans. There are some packet filtering products that block requests using Nmap’s default HTTP user agent. You can use a different user agent value by setting the argument http.useragent:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-p80</span> <span class="nt">--script</span> http-sqli-finder <span class="nt">--script-args</span> http.useragent<span class="o">=</span><span class="s2">"Mozilla 42"</span> 192.168.x.x
</pre></table></code></div></div><p>To set the user agent in your NSE script, you can pass the header field, as follows:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>options <span class="o">=</span> <span class="o">{</span><span class="nv">header</span><span class="o">={}}</span>    options[<span class="s1">'header'</span><span class="o">][</span><span class="s1">'User-Agent'</span><span class="o">]</span> <span class="o">=</span> <span class="s2">"Mozilla/9.1 (compatible; Windows       NT 5.0 build 1420;)"</span>    <span class="nb">local </span>req <span class="o">=</span> http.get<span class="o">(</span>host, port, uri, options<span class="o">)</span>
</pre></table></code></div></div><p>The problem is that this is burdensome to add (and remember)  everytime you need it.</p><h3 id="nmap-how-to-change-user-agent"><span class="mr-2">NMAP How to change user agent</span><a href="#nmap-how-to-change-user-agent" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>You can find the default value in <code class="language-plaintext highlighter-rouge">/usr/share/nmap/nselib/http.lua</code> (At the beginning of the file, a couple of lines after the comments)</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">local </span>USER_AGENT <span class="o">=</span> stdnse.get_script_args<span class="o">(</span><span class="s1">'http.useragent'</span><span class="o">)</span> or <span class="s2">"Mozilla/5.0 (compatible; Nmap Scripting Engine; http://nmap.org/book/nse.html)"</span>
</pre></table></code></div></div><p>You can change the value with this line</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">local </span>USER_AGENT <span class="o">=</span> stdnse.get_script_args<span class="o">(</span><span class="s1">'http.useragent'</span><span class="o">)</span> or <span class="s2">"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)"</span>
</pre></table></code></div></div><p>You can set it to whatever you like, stealth is key, change it periodically etc.</p><h2 id="mac-address-spoofing"><span class="mr-2">MAC Address Spoofing</span><a href="#mac-address-spoofing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Another method for bypassing firewall restrictions while doing a port scan is by spoofing the MAC address of your host.This technique can be very effective especially if there is a MAC filtering rule to allow only traffic from certain MAC addresses so you will need to discover which MAC address you need to set in order to obtain results.</p><p>Specifically the –spoof-mac option gives you the ability to choose a MAC address from a specific vendor,to choose a random MAC address or to set a specific MAC address of your choice.Another advantage of MAC address spoofing is that you make your scan more stealthier because your real MAC address it will not appear on the firewall log files.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>nmap <span class="nt">-Pn</span> <span class="nt">-sV</span> <span class="nt">--spoof-mac</span> 0 192.168.x.x <span class="c">#Generate a random MAC address —-&gt; —spoof-mac 0</span>
nmap <span class="nt">-Pn</span> <span class="nt">-sV</span> <span class="nt">--spoof-mac</span> Dell 192.168.x.x <span class="c">#Specify MAC address from a Vendor —-&gt; –spoof-mac Dell/Apple/3Com</span>
nmap <span class="nt">-Pn</span> <span class="nt">-sV</span> <span class="nt">--spoof-mac</span> 00:0C:29:6F:D9:6A 192.168.x.x <span class="c">#Specify your own MAC address —-&gt; —spoof-mac 00:0C:29:6F:D9:6A (For example NAC, IT Personal MAC Address)</span>
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/red-team/evasion9.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/red-team/evasion10.png" alt="Untitled" data-proofer-ignore></p><h2 id="host-detection-methods---ping-suppression"><span class="mr-2">Host Detection Methods - Ping Suppression</span><a href="#host-detection-methods---ping-suppression" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Typically, security administrators block ICMP (echo request, echo response) ping on the firewall to prevent outside attackers from discovering active hosts.</p><p>When we Scan with Nmap it sends an ICMP Request to see if the host is available and open. If no response, informs that the host is not working. Using the <code class="language-plaintext highlighter-rouge">-Pn</code> switch we can scan our target without sending the default ICMP.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>nmap <span class="nt">-Pn</span> 192.168.x.x <span class="c">#No ping scan</span>
<span class="nb">sudo </span>nmap <span class="nt">-sn</span> <span class="nt">-PA</span> 192.168.x.x <span class="c">#ACK Ping scan</span>
<span class="nb">sudo </span>nmap <span class="nt">-sn</span> <span class="nt">-PU</span> 192.168.x.x <span class="c">#UDP Ping scan</span>
<span class="nb">sudo </span>nmap <span class="nt">-sn</span> <span class="nt">-PS</span> 192.168.x.x <span class="c">#TCP SYN Ping</span>
<span class="nb">sudo </span>nmap <span class="nt">-sn</span> <span class="nt">-PR</span> 192.168.x.x <span class="c">#ARP Ping</span>
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/red-team/evasion11.png" alt="nmap ICMP scan -1" data-proofer-ignore> <em>nmap ICMP scan -1</em></p><p><img data-src="/assets/img/pitcures/red-team/evasion12.png" alt="nmap ICMP scan -2" data-proofer-ignore> <em>nmap ICMP scan -2</em></p><p><img data-src="/assets/img/pitcures/red-team/evasion13.png" alt="nmap ICMP scan -3" data-proofer-ignore> <em>nmap ICMP scan -3</em></p><p><img data-src="/assets/img/pitcures/red-team/evasion14.png" alt="nmap ACK ping scan" data-proofer-ignore> <em>nmap ACK ping scan</em></p><h2 id="fragmentation"><span class="mr-2">Fragmentation</span><a href="#fragmentation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="fragment-packets"><span class="mr-2">Fragment Packets</span><a href="#fragment-packets" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This is a very general concept and can be used in many different situations, for example: the fragmentation technique is useful for escaping the firewall if the target machine does not have the capabilities to handle larger packets. The parameter for this technique is -f, it simply splits the request into segments of small IP packets called fragmented IP packets. You can use -f twice -ff if you want to break IP headers further.</p><p>In this attack, nmap will split the IP header into many small pieces to escape the IDS. The pieces are then reassembled at the destination. Because IDS relies on signatures very similar to AV software, parts will not match the signature IDS is looking for. This, will allow the fragments to traverse the network where they will be reassembled on the target machine and do a port scan.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sT</span> <span class="nt">-f</span> 192.168.x.x
nmap <span class="nt">-sV</span> <span class="nt">-ff</span> 192.168.x.x <span class="c">#if you want to break IP headers further.</span>
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/red-team/evasion15.png" alt="Fragment Packets - Nmap" data-proofer-ignore> <em>Fragment Packets - Nmap</em></p><p><img data-src="/assets/img/pitcures/red-team/evasion16.png" alt="Capture a fragment packet" data-proofer-ignore> <em>Capture a fragment packet</em></p><h3 id="specify-a-specific-mtu"><span class="mr-2">Specify a specific MTU</span><a href="#specify-a-specific-mtu" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Nmap is giving the option to the user to set a specific MTU (Maximum Transmission Unit) to the packet. This is similar to the packet fragmentation technique that we have explained above. During the scan that size of the nmap will create packets with size based on the number that we will give. In this example we gave the number 32 so the nmap will create 32-byte packets causing a confusion to the firewall. Have in mind that the MTU number must be a multiple of 8 (8,16,24,32 etc). You can specify the MTU of your choice with the command –mtu number target.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sV</span> <span class="nt">--mtu</span> 32 192.168.x.x
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/red-team/evasion17.png" alt="Specify a specific MTU to the packets" data-proofer-ignore> <em>Specify a specific MTU to the packets</em></p><p><img data-src="/assets/img/pitcures/red-team/evasion18.png" alt="Untitled" data-proofer-ignore></p><h2 id="timing"><span class="mr-2">Timing</span><a href="#timing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The scheduling option is a very important and interesting feature of an Nmap because sometimes you have to make a delay between each request. There are many reasons for this, but the most important reason is the stress on the network; sometimes the victim’s computer or even a network cannot handle a large request. As a penetration tester, you need to make sure that your scan should not be considered a Denial of Service attack (DoS), so timely response and request are very important considerations in scanning. Nmap has many features and parameters that can be very useful for scanning a target in a timely manner; fragmentation technique as discussed (-f) is also a useful technique for splitting your request into multiple partitions. Other important parameters are discussed below:</p><h3 id="delay-scan_delay"><span class="mr-2">Delay (–scan_delay)</span><a href="#delay-scan_delay" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This is the best parameter to use to control the delay between each request. Remember to use the timing in integer format and mention the unit of time as you can control the time between each probe.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>nmap <span class="nt">-Pn</span> <span class="nt">-scan-delay</span> 5s <span class="nt">-sV</span> 192.168.x.x
<span class="c">#ms (milisecond) | #s (second) | #m (minute) | #h (hour)</span>
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/red-team/evasion19.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/red-team/evasion20.png" alt="Untitled" data-proofer-ignore></p><h3 id="host-timeout-option-host-timeout"><span class="mr-2">Host Timeout Option (–host-timeout)</span><a href="#host-timeout-option-host-timeout" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Sometimes a host takes too much time to respond and if you are scanning an entire network then it is very difficult to wait for a single host. There might be so many reasons behind a slow response, for example the network connectivity and the firewall, so if you don’t want to waste your time then you can set a time limit.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">--host-timeout</span> 10m 192.168.x.x
</pre></table></code></div></div><h2 id="idle-zombie-scan"><span class="mr-2">Idle Zombie Scan</span><a href="#idle-zombie-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This technique allows you to use another host on the network that is idle in order to perform a port scan to another host.The main advantage of this method is that it very stealthy because the firewall log files will record the IP address of the Zombie and not our IP.However in order to have proper results we must found hosts that are idle on the network.</p><p>Metasploit framework has a scanner that can help us to discover hosts that are idle on the network and it can be used while implementing this type of scan.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>msf&gt; use auxiliary/scanner/ip/ipidseq
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/red-team/evasion21.png" alt="Untitled" data-proofer-ignore></p><p>As we can see from the image above, the scanner has discovered that the IP address 192.168.2.25 is idle on the network and are potential candidates for Idle Zombie Scan. To implement an Idle Zombie scan, what we need is to use the command:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sI</span> 192.168.2.25 192.168.x.x <span class="c">#192.168.2.25 = idle on the network and candidates for Idle Zombie Scan</span>
</pre></table></code></div></div><h2 id="changing-data-length"><span class="mr-2">Changing Data length</span><a href="#changing-data-length" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Many firewalls are inspecting packets by looking at their size in order to identify a potential port scan. This is because many scanners are sending packets that have specific size. In order to avoid that kind of detection you can use the command <code class="language-plaintext highlighter-rouge">--data-length</code> to add additional data and to send packets with different size than the default. In the image below we have changed the packet size by adding 25 more bytes.</p><p><img data-src="/assets/img/pitcures/red-team/evasion22.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/red-team/evasion23.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/red-team/evasion24.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/red-team/evasion25.png" alt="Untitled" data-proofer-ignore></p><h2 id="random-scan"><span class="mr-2">Random Scan</span><a href="#random-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Shuffles each group of 16384 hosts before scanning. Combined with the slow timing options in Nmap, this technique can be very effective when you don’t want to alert the firewall.</p><blockquote class="prompt-tip"><div><p>This scan is quite slow when scanning large IP ranges.</p></div></blockquote><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap <span class="nt">-sV</span> <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-Pn</span> <span class="nt">-n</span> <span class="nt">--randomize-hosts</span> <span class="nt">-T4</span> 192.168.x.x/24
</pre></table></code></div></div><p><img data-src="/assets/img/pitcures/red-team/evasion26.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/pitcures/red-team/evasion27.png" alt="Untitled" data-proofer-ignore></p><h2 id="using-multiple-techniques"><span class="mr-2">Using Multiple Techniques</span><a href="#using-multiple-techniques" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://pentestlab.blog/2012/04/02/nmap-techniques-for-avoiding-firewalls/">https://pentestlab.blog/2012/04/02/nmap-techniques-for-avoiding-firewalls/</a></p><p>Firewall Evasion Techniques using Nmap (<a href="https://infosecwriteups.com/firewall-evasion-techniques-using-nmap-523dd18b1b1c">https://infosecwriteups.com/firewall-evasion-techniques-using-nmap-523dd18b1b1c</a>)</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/red-team/'>red team</a>, <a href='/categories/reconing/'>reconing</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/evasion-tactics/" class="post-tag no-text-decoration" >evasion tactics</a> <a href="/tags/evasion-technique/" class="post-tag no-text-decoration" >evasion technique</a> <a href="/tags/active-scan-evasion-tactics/" class="post-tag no-text-decoration" >active scan evasion tactics</a> <a href="/tags/port-scan-evasion-tactics/" class="post-tag no-text-decoration" >port scan evasion tactics</a> <a href="/tags/bypass-ids/" class="post-tag no-text-decoration" >bypass IDS</a> <a href="/tags/bypass-ips/" class="post-tag no-text-decoration" >bypass IPS</a> <a href="/tags/bypass-firewall/" class="post-tag no-text-decoration" >bypass firewall</a> <a href="/tags/bypass-waf/" class="post-tag no-text-decoration" >bypass waf</a> <a href="/tags/red-team/" class="post-tag no-text-decoration" >red-team</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Evasion+Tactics+For+Scanning+Targets+%28Active+Scan%29+-+secybr+%7C+penetration+testing%2C+red+teaming+and+hack+tricks.&url=https%3A%2F%2Fsecybr.com%2Fposts%2Fevasion-tactics-for-scanning-targets%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Evasion+Tactics+For+Scanning+Targets+%28Active+Scan%29+-+secybr+%7C+penetration+testing%2C+red+teaming+and+hack+tricks.&u=https%3A%2F%2Fsecybr.com%2Fposts%2Fevasion-tactics-for-scanning-targets%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fsecybr.com%2Fposts%2Fevasion-tactics-for-scanning-targets%2F&text=Evasion+Tactics+For+Scanning+Targets+%28Active+Scan%29+-+secybr+%7C+penetration+testing%2C+red+teaming+and+hack+tricks." data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/subdomain-enumeration-methods/">Subdomain Enumeration Methods</a><li><a href="/posts/shodan-tutorials-for-best-practicies/">Shodan.io Tutorials for Best Practices</a><li><a href="/posts/collecting-target-email-address/">Collecting Target Email Addresses</a><li><a href="/posts/evasion-tactics-for-scanning-targets/">Evasion Tactics For Scanning Targets (Active Scan)</a><li><a href="/posts/dumping-lsass-without-mimikatz/">Dumping LSASS Without Mimikatz</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/best-practicies/">best practicies</a> <a class="post-tag" href="/tags/red-team/">red-team</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/active-scan-evasion-tactics/">active scan evasion tactics</a> <a class="post-tag" href="/tags/asset-discovery-methods/">asset discovery methods</a> <a class="post-tag" href="/tags/asset-discovery/">asset discovery</a> <a class="post-tag" href="/tags/asset-enumeration-methods/">asset enumeration methods</a> <a class="post-tag" href="/tags/assets-of-target/">assets of target</a> <a class="post-tag" href="/tags/attack-detection-mechanism/">attack detection mechanism</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/subdomain-enumeration-methods/"><div class="card-body"> <em class="small" data-ts="1669842000" data-df="ll" > Dec 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Subdomain Enumeration Methods</h3><div class="text-muted small"><p> One of the first things to do in the discovery phase is to collect as many systems and IP addresses as possible without touching them. First of all, we need to find domains and subdomains. In this ...</p></div></div></a></div><div class="card"> <a href="/posts/asset-discovery-for-target/"><div class="card-body"> <em class="small" data-ts="1669928400" data-df="ll" > Dec 2, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Asset Discovery for Target</h3><div class="text-muted small"><p> Finding Netblock Addres From Company Name You can find NetblockTool on Github. #NetblockTool #Simple run. Get results from Google dorking and ARIN database: python3 NetblockTool.py Company #Inclu...</p></div></div></a></div><div class="card"> <a href="/posts/recon-ng-tutorials/"><div class="card-body"> <em class="small" data-ts="1670014800" data-df="ll" > Dec 3, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Recon-ng Tutorials for Enumeration Targets</h3><div class="text-muted small"><p> Recon-ng Basics Firstly we need to create a workspaces related to the target organization. It will gather our research and findings under these workspaces. workspaces list workspaces create examp...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/security-devices-and-software-types-to-detect-scans/" class="btn btn-outline-primary" prompt="Older"><p>Security Devices and Software types to Detect Scans</p></a> <a href="/posts/collecting-target-email-address/" class="btn btn-outline-primary" prompt="Newer"><p>Collecting Target Email Addresses</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://secybr.com/posts/evasion-tactics-for-scanning-targets/'; this.page.identifier = '/posts/evasion-tactics-for-scanning-targets/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://secybr-com.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div><div class="row justify-content-center border-top"> <small class="my-4">Powered by <a href="https://twitter.com/0xhav0c" target="_blank" rel="noopener noreferrer">0xhav0c</a> © 2022 - <a href="/privacy-policy/">Privacy Policy</a> </small></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/best-practicies/">best practicies</a> <a class="post-tag" href="/tags/red-team/">red-team</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/active-scan-evasion-tactics/">active scan evasion tactics</a> <a class="post-tag" href="/tags/asset-discovery-methods/">asset discovery methods</a> <a class="post-tag" href="/tags/asset-discovery/">asset discovery</a> <a class="post-tag" href="/tags/asset-enumeration-methods/">asset enumeration methods</a> <a class="post-tag" href="/tags/assets-of-target/">assets of target</a> <a class="post-tag" href="/tags/attack-detection-mechanism/">attack detection mechanism</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-XBEEHR73W1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-XBEEHR73W1'); }); </script>
